---
alwaysApply: true
---
# ğŸ›¡ï¸ SmartAbpä»£ç è´¨é‡å¼ºåˆ¶æ‰§è¡Œè§„åˆ™

## âš¡ è´¨é‡é“å¾‹ï¼ˆé›¶å®¹é”™ï¼‰

### 0. BUGä¿®å¤é“å¾‹ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
**ğŸš¨ ä¿®å¤é”™è¯¯æ—¶ç»å¯¹ç¦æ­¢çš„è¡Œä¸ºï¼š**

```typescript
// âŒ ç»å¯¹ç¦æ­¢ï¼šåˆ é™¤æŠ¥é”™ä»£ç æ¥"ä¿®å¤"é”™è¯¯
// function problematicFunction(param: string) {
//   return param.toUpperCase(); // è¢«åˆ é™¤
// }

// âŒ ç»å¯¹ç¦æ­¢ï¼šä½¿ç”¨as anyç»•è¿‡ç±»å‹æ£€æŸ¥
const result = unknownValue as any; // ä¸¥ç¦

// âŒ ç»å¯¹ç¦æ­¢ï¼šä½¿ç”¨_å‰ç¼€è§„é¿"æœªä½¿ç”¨"è­¦å‘Š  
function process(_unusedParam: string, data: Data) {} // ä¸¥ç¦

// âŒ ç»å¯¹ç¦æ­¢ï¼šæ³¨é‡Šæ‰æŠ¥é”™ä»£ç 
// const problematicCode = getValue(); // ä¸¥ç¦

// âœ… æ­£ç¡®åšæ³•ï¼šæ·±å…¥ç†è§£é”™è¯¯ï¼Œå®ç°åŠŸèƒ½æ€§ä¿®å¤
interface ProcessedData {
  value: string;
  processed: boolean;
}

function processData(inputParam: string): ProcessedData {
  // ç†è§£inputParamçš„ä½œç”¨ï¼Œæ­£ç¡®ä½¿ç”¨
  return {
    value: inputParam.toUpperCase(),
    processed: true
  };
}
```

**ğŸ”´ BUGä¿®å¤é»„é‡‘å‡†åˆ™ï¼š**
1. **æ·±å…¥ç†è§£é”™è¯¯æ ¹æº** - ä¸æ˜¯ç—‡çŠ¶ï¼Œæ˜¯æ ¹æœ¬åŸå› 
2. **æŸ¥é˜…ç›¸å…³æ–‡æ¡£å’ŒAPI** - ä½¿ç”¨æ­£ç¡®çš„æ¥å£å’Œå‚æ•°
3. **å¢å¼ºåŠŸèƒ½è€Œéåˆ å‡** - ä¿®å¤çš„åŒæ—¶æå‡ä»£ç è´¨é‡
4. **ä¿æŒç±»å‹å®‰å…¨** - ç»ä¸ä½¿ç”¨anyæˆ–å¼ºåˆ¶ç±»å‹è½¬æ¢é€ƒé¿
5. **æµ‹è¯•ä¿®å¤æ•ˆæœ** - ç¡®ä¿ä¿®å¤æ²¡æœ‰å¼•å…¥æ–°é—®é¢˜

### 1. æ„å»ºè´¨é‡æ£€æŸ¥
**ğŸ”´ æ¯æ¬¡ä»£ç ä¿®æ”¹åå¼ºåˆ¶æ‰§è¡Œï¼š**

```bash
# å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼Œå…¨éƒ¨é€šè¿‡æ‰èƒ½ç»§ç»­ (åŸºäºé¡¹ç›®å®é™…scripts)
npm run type-check   # âŒ ä»»ä½•ç±»å‹é”™è¯¯ = ç«‹å³åœæ­¢
npm run lint         # âŒ ä»»ä½•linté”™è¯¯ = ç«‹å³åœæ­¢  
npm run test:coverage # âŒ æµ‹è¯•è¦†ç›–ç‡<80% = ç«‹å³åœæ­¢
npm run build        # âŒ ä»»ä½•æ„å»ºé”™è¯¯ = ç«‹å³åœæ­¢
npm run dev          # âŒ è¿è¡Œæ—¶é”™è¯¯ = ç«‹å³åœæ­¢
npm run stylelint    # âŒ æ ·å¼è§„èŒƒé”™è¯¯ = ç«‹å³åœæ­¢ (é¡¹ç›®ç‰¹æœ‰)
```

### 2. ä»£ç é‡å¤æ£€æµ‹
**ğŸ”´ ä¸¥ç¦ä»»ä½•å½¢å¼çš„ä»£ç é‡å¤ï¼š**

```typescript
// âŒ ä¸¥ç¦ï¼šé‡å¤çš„å‡½æ•°å®ç°
// æ–‡ä»¶A
function formatDate(date: Date): string {
  return date.toLocaleDateString()
}

// æ–‡ä»¶B  
function formatDate(date: Date): string {  // âŒ é‡å¤å®ç°
  return date.toLocaleDateString()
}

// âœ… æ­£ç¡®ï¼šå…±äº«å·¥å…·å‡½æ•°
// utils/dateUtils.ts
export function formatDate(date: Date): string {
  return date.toLocaleDateString()
}
```

### 3. TypeScriptä¸¥æ ¼æ¨¡å¼
**ğŸ”´ å¼ºåˆ¶å¯ç”¨æ‰€æœ‰ä¸¥æ ¼æ£€æŸ¥ï¼š**

```json
// tsconfig.json - å¼ºåˆ¶é…ç½® (ä¸é¡¹ç›®å®é™…é…ç½®åŒæ­¥)
{
  "compilerOptions": {
    "target": "ES2020",               // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "lib": ["ES2020", "DOM", "DOM.Iterable"], // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "module": "ESNext",               // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "moduleResolution": "bundler",    // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "strict": true,                   // âœ… å¿…é¡»å¯ç”¨
    "noImplicitAny": true,           // âœ… ç¦æ­¢éšå¼any
    "strictNullChecks": true,        // âœ… ä¸¥æ ¼ç©ºå€¼æ£€æŸ¥
    "strictFunctionTypes": true,     // âœ… ä¸¥æ ¼å‡½æ•°ç±»å‹
    "noImplicitReturns": true,       // âœ… å¿…é¡»æ˜¾å¼è¿”å›
    "noUnusedLocals": true,          // âœ… ç¦æ­¢æœªä½¿ç”¨å˜é‡
    "noUnusedParameters": true,      // âœ… ç¦æ­¢æœªä½¿ç”¨å‚æ•°
    "skipLibCheck": true,            // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "allowSyntheticDefaultImports": true, // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "resolveJsonModule": true,       // âœ… ä¸é¡¹ç›®ä¸€è‡´
    "isolatedModules": true,         // âœ… Viteè¦æ±‚
    "useDefineForClassFields": true, // âœ… ç°ä»£ç±»å­—æ®µè¯­æ³•
    "noEmit": true                   // âœ… ä»…ç±»å‹æ£€æŸ¥ï¼Œä¸è¾“å‡º
  }
}
```

### 4. ESLintå¼ºåˆ¶è§„åˆ™
**ğŸ”´ å¼ºåˆ¶æ‰§è¡Œçš„ä»£ç è§„èŒƒï¼š**

```typescript
// âœ… å¼ºåˆ¶ä½¿ç”¨ï¼šæ˜ç¡®çš„ç±»å‹å®šä¹‰ (ç¬¦åˆé¡¹ç›®ä»£ç é£æ ¼)
interface UserInfo {
  id: string
  name: string
  email: string
  createdAt: Date
}

const user: UserInfo = {
  id: "123",                          // âœ… åŒå¼•å· (ä¸.prettierrc.jsonä¸€è‡´)
  name: "John",                       // âœ… åŒå¼•å·
  email: "john@example.com",          // âœ… åŒå¼•å·
  createdAt: new Date(),              // âœ… å°¾éšé€—å·
}

// âŒ ä¸¥ç¦ï¼šç±»å‹æ¨æ–­çš„å±é™©ç”¨æ³•
const user = {  // âŒ æ²¡æœ‰æ˜ç¡®ç±»å‹
  id: "123",
  name: "John"
}
```

## ğŸ§¹ ä»£ç æ¸…æ´åº¦å¼ºåˆ¶è¦æ±‚

### å‡½æ•°å¤æ‚åº¦é™åˆ¶
```typescript
// âœ… æ­£ç¡®ï¼šç®€å•æ˜ç¡®çš„å‡½æ•°
function validateEmail(email: string): boolean {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  return emailRegex.test(email)
}

// âŒ ä¸¥ç¦ï¼šå¤æ‚çš„å·¨å‹å‡½æ•°ï¼ˆåœˆå¤æ‚åº¦ > 10ï¼‰
function complexValidation(data: any): any {  // âŒ ç¦æ­¢
  if (data.type === 'user') {
    if (data.email) {
      if (data.email.includes('@')) {
        if (data.name) {
          if (data.name.length > 2) {
            // ... è¶…è¿‡10å±‚åµŒå¥— = ç¦æ­¢
          }
        }
      }
    }
  }
}
```

### å‘½åæ¸…æ™°åº¦è¦æ±‚
```typescript
// âœ… å¼ºåˆ¶ä½¿ç”¨ï¼šè¯­ä¹‰æ˜ç¡®çš„å‘½å
const getUserById = async (userId: string): Promise<UserInfo> => {
  const user = await userRepository.findById(userId)
  if (!user) {
    throw new Error(`User with id ${userId} not found`)
  }
  return user
}

// âŒ ä¸¥ç¦ï¼šæ¨¡ç³Šçš„å‘½å
const getData = async (id: any): Promise<any> => {  // âŒ ç¦æ­¢
  const result = await repo.find(id)  // âŒ ç¦æ­¢
  return result
}
```

## ğŸ“ æ–‡ä»¶å¤§å°é™åˆ¶

### å¼ºåˆ¶æ–‡ä»¶å¤§å°é™åˆ¶
```typescript
// âœ… å…è®¸çš„æ–‡ä»¶å¤§å°
// Vueç»„ä»¶: < 300è¡Œ
// TypeScriptæ–‡ä»¶: < 500è¡Œ
// å·¥å…·å‡½æ•°æ–‡ä»¶: < 200è¡Œ

// âŒ è¶…è¿‡é™åˆ¶å¿…é¡»æ‹†åˆ†
// å•ä¸ªVueç»„ä»¶ > 300è¡Œ = å¼ºåˆ¶æ‹†åˆ†ä¸ºå¤šä¸ªç»„ä»¶
// å•ä¸ªTSæ–‡ä»¶ > 500è¡Œ = å¼ºåˆ¶æ‹†åˆ†ä¸ºå¤šä¸ªæ¨¡å—
```

### ç»„ä»¶å¤æ‚åº¦æ§åˆ¶
```vue
<!-- âœ… æ­£ç¡®ï¼šç®€å•ä¸“æ³¨çš„ç»„ä»¶ -->
<template>
  <div class="user-card">
    <h3>{{ user.name }}</h3>
    <p>{{ user.email }}</p>
  </div>
</template>

<script setup lang="ts">
interface Props {
  user: UserInfo
}

defineProps<Props>()
</script>

<!-- âŒ ä¸¥ç¦ï¼šå·¨å‹ç»„ä»¶ï¼ˆ>300è¡Œï¼‰ -->
<!-- åŒ…å«å¤šä¸ªä¸šåŠ¡é€»è¾‘çš„å¤æ‚ç»„ä»¶ = å¿…é¡»æ‹†åˆ† -->
```

## ğŸ”’ å®‰å…¨æ€§å¼ºåˆ¶è¦æ±‚

### è¾“å…¥éªŒè¯
```typescript
// âœ… å¼ºåˆ¶ä½¿ç”¨ï¼šä¸¥æ ¼çš„è¾“å…¥éªŒè¯
function createUser(input: CreateUserRequest): Promise<UserInfo> {
  // éªŒè¯å¿…å¡«å­—æ®µ
  if (!input.name?.trim()) {
    throw new ValidationError('Name is required')
  }
  
  if (!input.email?.trim()) {
    throw new ValidationError('Email is required')
  }
  
  // éªŒè¯æ ¼å¼
  if (!isValidEmail(input.email)) {
    throw new ValidationError('Invalid email format')
  }
  
  return userService.create(input)
}

// âŒ ä¸¥ç¦ï¼šç›´æ¥ä½¿ç”¨æœªéªŒè¯çš„è¾“å…¥
function createUser(input: any): Promise<any> {  // âŒ ç¦æ­¢
  return userService.create(input)  // âŒ æœªéªŒè¯çš„è¾“å…¥
}
```

### é”™è¯¯å¤„ç†
```typescript
// âœ… å¼ºåˆ¶ä½¿ç”¨ï¼šå®Œæ•´çš„é”™è¯¯å¤„ç†
async function fetchUserData(userId: string): Promise<UserInfo> {
  try {
    const response = await userApi.getUser(userId)
    
    if (!response.success) {
      throw new ApiError(`Failed to fetch user: ${response.message}`)
    }
    
    if (!isValidUser(response.data)) {
      throw new ValidationError('Invalid user data received')
    }
    
    return response.data
  } catch (error) {
    logger.error('Error fetching user data', { userId, error })
    throw error
  }
}

// âŒ ä¸¥ç¦ï¼šå¿½ç•¥é”™è¯¯å¤„ç†
async function fetchUserData(userId: string): Promise<any> {
  const response = await userApi.getUser(userId)  // âŒ æ— é”™è¯¯å¤„ç†
  return response.data  // âŒ ä¸æ£€æŸ¥å“åº”çŠ¶æ€
}
```

## ğŸ§ª æµ‹è¯•è¦†ç›–ç‡è¦æ±‚

### å¼ºåˆ¶æµ‹è¯•è¦†ç›–ç‡ (åŸºäºVitest 2.1.8é…ç½®)
```typescript
// âœ… å¿…é¡»è¾¾åˆ°çš„è¦†ç›–ç‡æŒ‡æ ‡ (ä¸vitest.config.tsä¸€è‡´)
// å‡½æ•°è¦†ç›–ç‡: >80%  (é¡¹ç›®æ ‡å‡†)
// è¡Œè¦†ç›–ç‡: >80%    (é¡¹ç›®æ ‡å‡†)
// åˆ†æ”¯è¦†ç›–ç‡: >80%  (é¡¹ç›®æ ‡å‡†)
// è¯­å¥è¦†ç›–ç‡: >80%  (é¡¹ç›®æ ‡å‡†)

// âœ… å¿…é¡»æµ‹è¯•çš„å‡½æ•°ç±»å‹
// 1. æ‰€æœ‰publicæ–¹æ³•
// 2. æ‰€æœ‰ä¸šåŠ¡é€»è¾‘å‡½æ•°
// 3. æ‰€æœ‰APIè°ƒç”¨å‡½æ•°
// 4. æ‰€æœ‰æ•°æ®è½¬æ¢å‡½æ•°
// 5. æ‰€æœ‰Vueç»„ä»¶çš„æ ¸å¿ƒé€»è¾‘

// âœ… Vitestæµ‹è¯•ç¤ºä¾‹ (ç¬¦åˆé¡¹ç›®è§„èŒƒ)
describe("UserService", () => {
  it("should create user with valid data", async () => {
    const userData = { name: "John", email: "john@test.com" }
    const result = await userService.create(userData)
    expect(result).toBeDefined()
    expect(result.id).toBeTruthy()
  })
  
  it("should throw error for invalid email", async () => {
    const userData = { name: "John", email: "invalid-email" }
    await expect(userService.create(userData))
      .rejects.toThrow("Invalid email format")
  })
  
  // âœ… Vueç»„ä»¶æµ‹è¯•ç¤ºä¾‹
  it("should render user info correctly", () => {
    const wrapper = mount(UserCard, {
      props: { user: mockUser }
    })
    expect(wrapper.find(".user-name").text()).toBe(mockUser.name)
  })
})
```

## ğŸ“Š æ€§èƒ½è¦æ±‚

### å¼ºåˆ¶æ€§èƒ½æ ‡å‡† (åŸºäºVue 3.5.13 + Vite 6.0.5)
```typescript
// âœ… å¿…é¡»æ»¡è¶³çš„æ€§èƒ½æŒ‡æ ‡ (ç°ä»£Webæ ‡å‡†)
// First Contentful Paint: <1.5s
// Largest Contentful Paint: <2.5s
// Cumulative Layout Shift: <0.1
// First Input Delay: <100ms
// Vueç»„ä»¶æ¸²æŸ“æ—¶é—´: <16ms (60fps)
// APIå“åº”æ—¶é—´: <200ms
// åˆå§‹åŒ…å¤§å°: <3MB (Viteä¼˜åŒ–å)

// âœ… å¼ºåˆ¶ä½¿ç”¨ï¼šVue 3æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯
// 1. Vueç»„ä»¶æ‡’åŠ è½½ (defineAsyncComponent)
const UserManagement = defineAsyncComponent(
  () => import("@/views/user/UserManagement.vue")
)

// 2. APIè¯·æ±‚å»é‡ä¸ç¼“å­˜
const userCache = new Map<string, Promise<UserInfo>>()
const getUserById = (id: string): Promise<UserInfo> => {
  if (!userCache.has(id)) {
    userCache.set(id, userApi.getUser(id))
  }
  return userCache.get(id)!
}

// 3. è®¡ç®—å±æ€§ç¼“å­˜ (Vue 3å“åº”å¼ç³»ç»Ÿ)
const expensiveComputation = computed(() => {
  return heavyCalculation(props.data)  // è‡ªåŠ¨ç¼“å­˜
})

// 4. PiniaçŠ¶æ€ç®¡ç†ä¼˜åŒ–
const useUserStore = defineStore("user", () => {
  const users = ref<UserInfo[]>([])
  
  const getUserById = computed(() => {
    return (id: string) => users.value.find(u => u.id === id)
  })
  
  return { users, getUserById }
})

// 5. Element PlusæŒ‰éœ€å¯¼å…¥ (å‡å°‘åŒ…å¤§å°)
import { ElButton, ElTable } from "element-plus"
```

## ğŸš¨ è‡ªåŠ¨è´¨é‡æ£€æŸ¥

### ä»£ç æäº¤å‰å¼ºåˆ¶æ£€æŸ¥ (åŸºäºHusky + lint-staged)
```bash
#// Git pre-commité’©å­è‡ªåŠ¨æ‰§è¡Œ (ä¸package.json scriptsä¸€è‡´)
1. TypeScriptç±»å‹æ£€æŸ¥ (npm run type-check)
2. ESLintè§„èŒƒæ£€æŸ¥ (npm run lint)
3. Prettieræ ¼å¼åŒ– (npm run format)
4. æ ·å¼è§„èŒƒæ£€æŸ¥ (npm run stylelint)
5. å•å…ƒæµ‹è¯•æ‰§è¡Œ (npm run test:coverage)
6. æ„å»ºéªŒè¯ (npm run build)
7. E2Eæµ‹è¯• (npm run cypress:run) [å¯é€‰]
```

### è´¨é‡é—¨ç¦ (SmartAbpé¡¹ç›®æ ‡å‡†)
```typescript
// è´¨é‡é—¨ç¦æ ‡å‡† - æœªè¾¾æ ‡ç¦æ­¢åˆå¹¶
interface QualityGates {
  buildSuccess: true,           // âœ… Vite 6.0.5æ„å»ºå¿…é¡»æˆåŠŸ
  typeCheckPass: true,          // âœ… TypeScript 8.41.0ç±»å‹æ£€æŸ¥å¿…é¡»é€šè¿‡
  lintErrors: 0,                // âœ… ESLinté”™è¯¯å¿…é¡»ä¸º0
  stylelintErrors: 0,           // âœ… Stylelinté”™è¯¯å¿…é¡»ä¸º0 (é¡¹ç›®ç‰¹æœ‰)
  lintWarnings: 0,              // âœ… ESLintè­¦å‘Šå¿…é¡»ä¸º0
  testCoverage: ">=80%",        // âœ… Vitestæµ‹è¯•è¦†ç›–ç‡â‰¥80%
  testsPassing: true,           // âœ… æ‰€æœ‰æµ‹è¯•å¿…é¡»é€šè¿‡
  duplicatedCode: "<5%",        // âœ… é‡å¤ä»£ç <5%
  complexityScore: "<10",       // âœ… åœˆå¤æ‚åº¦<10
  performanceScore: ">90",      // âœ… Lighthouseæ€§èƒ½åˆ†æ•°>90
  accessibilityScore: ">90",    // âœ… å¯è®¿é—®æ€§åˆ†æ•°>90
  bundleSize: "<3MB",           // âœ… æ‰“åŒ…å¤§å°<3MB
  noConsoleLog: true,           // âœ… ç”Ÿäº§ä»£ç ç¦æ­¢console.log
  noDebugger: true,             // âœ… ç”Ÿäº§ä»£ç ç¦æ­¢debugger
  noTodoComments: true          // âœ… ç¦æ­¢TODOæ³¨é‡Šè¿›å…¥ä¸»åˆ†æ”¯
}
```

## âš ï¸ è´¨é‡è¿è§„å¤„ç†

### è‡ªåŠ¨å¤„ç†æœºåˆ¶
1. **æ„å»ºå¤±è´¥** â†’ è‡ªåŠ¨å›æ»šåˆ°ä¸Šä¸€æ¬¡æˆåŠŸçŠ¶æ€
2. **ç±»å‹é”™è¯¯** â†’ é˜»æ­¢ä»£ç æ‰§è¡Œï¼Œå¼ºåˆ¶ä¿®å¤
3. **Linté”™è¯¯** â†’ è‡ªåŠ¨ä¿®å¤ï¼Œæ— æ³•ä¿®å¤åˆ™é˜»æ­¢æäº¤
4. **æµ‹è¯•å¤±è´¥** â†’ é˜»æ­¢éƒ¨ç½²ï¼Œå¿…é¡»ä¿®å¤æµ‹è¯•
5. **æ€§èƒ½ä¸‹é™** â†’ å‘å‡ºè­¦æŠ¥ï¼Œè¦æ±‚æ€§èƒ½ä¼˜åŒ–

---

**ğŸ”’ ä»£ç è´¨é‡æ˜¯é¡¹ç›®ç”Ÿå‘½çº¿ï¼Œè´¨é‡æ ‡å‡†ä¸å¯å¦¥åï¼**