*Thinking...*

> 用户明确指出了现实约束：无法使用真正的AI大模型。需要调整方案，改为基于模板和规则的智能辅助系统。重点应该放在：
>
> 1. 精心设计的模板系统
> 2. 详细的注释和引导
> 3. 基于规则的智能推荐
> 4. 模板驱动的配置生成
> 5. 示例代码和最佳实践
>
> 我需要重新设计方案，去除所有AI大模型相关的功能，改为更实用的基于模板和规则引擎的方案。

# 🔧 企业级低代码平台2.0 - 实用模板驱动版

您说得对，让我重新设计一个更加务实、可立即落地的方案，基于**模板引擎**和**规则系统**来实现智能辅助。

## 一、智能模板配置系统（无AI大模型版）

### 1.1 模板驱动的配置引擎

```typescript
/**
 * 基于模板和规则的智能配置系统
 * 通过预定义模板、示例和规则引擎实现智能辅助
 */

namespace LowCode.Templates.Configuration;

/// <summary>
/// 配置模板引擎 - 基于规则和模板的智能辅助
/// </summary>
[Dependency(ServiceLifetime.Singleton)]
public class ConfigurationTemplateEngine : IConfigurationTemplateEngine
{
    private readonly ITemplateRepository _templateRepository;
    private readonly IRuleEngine _ruleEngine;
    private readonly IExampleProvider _exampleProvider;
    private readonly IValidationService _validationService;
    
    // 模板缓存
    private readonly Dictionary<string, ConfigurationTemplate> _templateCache = new();
    
    // 规则集合
    private readonly Dictionary<string, List<ConfigurationRule>> _rulesets = new();
    
    public ConfigurationTemplateEngine(
        ITemplateRepository templateRepository,
        IRuleEngine ruleEngine,
        IExampleProvider exampleProvider,
        IValidationService validationService)
    {
        _templateRepository = templateRepository;
        _ruleEngine = ruleEngine;
        _exampleProvider = exampleProvider;
        _validationService = validationService;
        
        InitializeTemplates();
        InitializeRules();
    }
    
    /// <summary>
    /// 初始化配置模板
    /// </summary>
    private void InitializeTemplates()
    {
        // 加载实体配置模板
        _templateCache["entity"] = new ConfigurationTemplate
        {
            Id = "entity",
            Name = "实体配置模板",
            Description = "用于配置领域实体的标准模板",
            Category = "domain",
            Version = "1.0.0",
            Schema = new JsonSchema
            {
                Type = "object",
                Properties = new Dictionary<string, JsonSchemaProperty>
                {
                    ["name"] = new JsonSchemaProperty
                    {
                        Type = "string",
                        Description = "实体名称（英文，首字母大写，如：Product）",
                        Pattern = "^[A-Z][a-zA-Z0-9]*$",
                        Examples = new[] { "Product", "Order", "Customer" },
                        Required = true
                    },
                    ["displayName"] = new JsonSchemaProperty
                    {
                        Type = "string",
                        Description = "显示名称（中文名，如：产品）",
                        Examples = new[] { "产品", "订单", "客户" },
                        Required = true
                    },
                    ["tableName"] = new JsonSchemaProperty
                    {
                        Type = "string",
                        Description = "数据库表名（默认为实体名复数形式）",
                        Pattern = "^[a-zA-Z][a-zA-Z0-9_]*$",
                        DefaultValue = "${name}s",
                        AutoGenerated = true
                    },
                    ["properties"] = new JsonSchemaProperty
                    {
                        Type = "array",
                        Description = "实体属性列表",
                        Items = new JsonSchema
                        {
                            Type = "object",
                            Properties = new Dictionary<string, JsonSchemaProperty>
                            {
                                ["name"] = new JsonSchemaProperty
                                {
                                    Type = "string",
                                    Description = "属性名称（驼峰命名，如：productName）",
                                    Pattern = "^[a-z][a-zA-Z0-9]*$",
                                    Required = true
                                },
                                ["type"] = new JsonSchemaProperty
                                {
                                    Type = "string",
                                    Description = "数据类型",
                                    Enum = new[] { "string", "int", "decimal", "datetime", "bool", "guid" },
                                    EnumDescriptions = new Dictionary<string, string>
                                    {
                                        ["string"] = "字符串类型",
                                        ["int"] = "整数类型",
                                        ["decimal"] = "小数类型",
                                        ["datetime"] = "日期时间类型",
                                        ["bool"] = "布尔类型",
                                        ["guid"] = "唯一标识符类型"
                                    },
                                    Required = true
                                },
                                ["maxLength"] = new JsonSchemaProperty
                                {
                                    Type = "integer",
                                    Description = "最大长度（仅适用于string类型）",
                                    Condition = "type == 'string'",
                                    DefaultValue = 50
                                },
                                ["required"] = new JsonSchemaProperty
                                {
                                    Type = "boolean",
                                    Description = "是否必填",
                                    DefaultValue = false
                                },
                                ["defaultValue"] = new JsonSchemaProperty
                                {
                                    Type = "string",
                                    Description = "默认值（可选）"
                                }
                            }
                        }
                    },
                    ["auditing"] = new JsonSchemaProperty
                    {
                        Type = "boolean",
                        Description = "是否启用审计（自动添加创建时间、修改时间等字段）",
                        DefaultValue = true
                    },
                    ["softDelete"] = new JsonSchemaProperty
                    {
                        Type = "boolean",
                        Description = "是否启用软删除",
                        DefaultValue = true
                    },
                    ["multiTenant"] = new JsonSchemaProperty
                    {
                        Type = "boolean",
                        Description = "是否支持多租户",
                        DefaultValue = false
                    }
                }
            },
            Examples = new List<ConfigurationExample>
            {
                new ConfigurationExample
                {
                    Name = "产品实体示例",
                    Description = "一个完整的产品实体配置示例",
                    Content = @"{
  // 实体基本信息
  ""name"": ""Product"",              // 实体类名
  ""displayName"": ""产品"",          // 中文显示名
  ""tableName"": ""Products"",        // 数据库表名（可选，默认自动生成）
  
  // 实体属性定义
  ""properties"": [
    {
      ""name"": ""name"",            // 产品名称
      ""type"": ""string"",
      ""displayName"": ""产品名称"",
      ""maxLength"": 100,
      ""required"": true,
      ""description"": ""产品的名称""
    },
    {
      ""name"": ""code"",            // 产品编码
      ""type"": ""string"",
      ""displayName"": ""产品编码"",
      ""maxLength"": 50,
      ""required"": true,
      ""unique"": true,             // 唯一约束
      ""description"": ""产品的唯一编码""
    },
    {
      ""name"": ""price"",           // 产品价格
      ""type"": ""decimal"",
      ""displayName"": ""价格"",
      ""precision"": 18,            // 精度
      ""scale"": 2,                 // 小数位数
      ""required"": true,
      ""min"": 0,                   // 最小值
      ""description"": ""产品的销售价格""
    },
    {
      ""name"": ""stock"",           // 库存数量
      ""type"": ""int"",
      ""displayName"": ""库存"",
      ""required"": true,
      ""defaultValue"": 0,
      ""min"": 0,
      ""description"": ""当前库存数量""
    },
    {
      ""name"": ""isActive"",        // 是否启用
      ""type"": ""bool"",
      ""displayName"": ""是否启用"",
      ""defaultValue"": true,
      ""description"": ""产品是否可用于销售""
    },
    {
      ""name"": ""categoryId"",      // 分类ID（外键）
      ""type"": ""guid"",
      ""displayName"": ""分类"",
      ""required"": false,
      ""foreignKey"": {             // 外键配置
        ""entity"": ""Category"",
        ""property"": ""Id"",
        ""onDelete"": ""SetNull""
      },
      ""description"": ""产品所属分类""
    }
  ],
  
  // 高级配置
  ""auditing"": true,               // 启用审计（自动添加CreationTime等）
  ""softDelete"": true,             // 启用软删除（自动添加IsDeleted）
  ""multiTenant"": false,           // 不启用多租户
  
  // 索引配置（可选）
  ""indexes"": [
    {
      ""properties"": [""code""],
      ""unique"": true
    },
    {
      ""properties"": [""categoryId"", ""isActive""],
      ""unique"": false
    }
  ]
}"
                }
            },
            QuickStart = @"
## 快速开始

1. **复制上方示例**：点击复制按钮获取完整示例
2. **修改基本信息**：
   - name: 修改为您的实体名（英文）
   - displayName: 修改为中文名
3. **配置属性**：
   - 根据业务需求添加/修改属性
   - 注意选择正确的数据类型
4. **设置高级选项**：
   - auditing: 是否需要审计字段
   - softDelete: 是否需要软删除
5. **验证配置**：点击验证按钮检查配置是否正确

## 常用数据类型说明

- **string**: 文本类型，需设置maxLength
- **int**: 整数，可设置min/max
- **decimal**: 小数，需设置precision/scale
- **datetime**: 日期时间
- **bool**: 布尔值（true/false）
- **guid**: 唯一标识符，常用于ID和外键

## 注意事项

⚠️ 实体名必须符合C#命名规范
⚠️ 属性名使用驼峰命名法
⚠️ 外键类型通常为guid
✅ 建议所有实体启用auditing
✅ 建议启用softDelete避免数据丢失
"
        };
        
        // 加载API配置模板
        _templateCache["api"] = new ConfigurationTemplate
        {
            Id = "api",
            Name = "API接口配置模板",
            Description = "用于配置应用服务接口的标准模板",
            Category = "application",
            Examples = GetApiExamples(),
            QuickStart = GetApiQuickStart()
        };
        
        // 加载更多模板...
    }
    
    /// <summary>
    /// 初始化规则引擎
    /// </summary>
    private void InitializeRules()
    {
        // 字段类型推断规则
        _rulesets["field-type-inference"] = new List<ConfigurationRule>
        {
            new ConfigurationRule
            {
                Name = "EmailFieldRule",
                Description = "识别邮箱字段",
                Condition = "name.Contains('email', StringComparison.OrdinalIgnoreCase) || name.Contains('mail', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "SetProperty", Property = "type", Value = "string" },
                    new RuleAction { Type = "SetProperty", Property = "maxLength", Value = "256" },
                    new RuleAction { Type = "SetProperty", Property = "validation", Value = "email" },
                    new RuleAction { Type = "SetProperty", Property = "placeholder", Value = "user@example.com" }
                }
            },
            new ConfigurationRule
            {
                Name = "PhoneFieldRule",
                Description = "识别电话字段",
                Condition = "name.Contains('phone', StringComparison.OrdinalIgnoreCase) || name.Contains('mobile', StringComparison.OrdinalIgnoreCase) || name.Contains('tel', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "SetProperty", Property = "type", Value = "string" },
                    new RuleAction { Type = "SetProperty", Property = "maxLength", Value = "20" },
                    new RuleAction { Type = "SetProperty", Property = "validation", Value = "phone" },
                    new RuleAction { Type = "SetProperty", Property = "placeholder", Value = "13800138000" }
                }
            },
            new ConfigurationRule
            {
                Name = "DateFieldRule",
                Description = "识别日期字段",
                Condition = "name.EndsWith('Date', StringComparison.OrdinalIgnoreCase) || name.EndsWith('Time', StringComparison.OrdinalIgnoreCase) || name.EndsWith('At', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "SetProperty", Property = "type", Value = "datetime" },
                    new RuleAction { Type = "SetProperty", Property = "format", Value = "yyyy-MM-dd HH:mm:ss" }
                }
            },
            new ConfigurationRule
            {
                Name = "BooleanFieldRule",
                Description = "识别布尔字段",
                Condition = "name.StartsWith('is', StringComparison.OrdinalIgnoreCase) || name.StartsWith('has', StringComparison.OrdinalIgnoreCase) || name.StartsWith('can', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "SetProperty", Property = "type", Value = "bool" },
                    new RuleAction { Type = "SetProperty", Property = "defaultValue", Value = "false" }
                }
            },
            new ConfigurationRule
            {
                Name = "IdFieldRule",
                Description = "识别ID字段",
                Condition = "name.EndsWith('Id', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "SetProperty", Property = "type", Value = "guid" },
                    new RuleAction { Type = "SetProperty", Property = "required", Value = "true" }
                }
            },
            new ConfigurationRule
            {
                Name = "PriceFieldRule",
                Description = "识别价格字段",
                Condition = "name.Contains('price', StringComparison.OrdinalIgnoreCase) || name.Contains('amount', StringComparison.OrdinalIgnoreCase) || name.Contains('cost', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "SetProperty", Property = "type", Value = "decimal" },
                    new RuleAction { Type = "SetProperty", Property = "precision", Value = "18" },
                    new RuleAction { Type = "SetProperty", Property = "scale", Value = "2" },
                    new RuleAction { Type = "SetProperty", Property = "min", Value = "0" }
                }
            }
        };
        
        // 关联字段生成规则
        _rulesets["related-fields"] = new List<ConfigurationRule>
        {
            new ConfigurationRule
            {
                Name = "EmailConfirmationRule",
                Description = "为Email字段生成确认字段",
                Condition = "type == 'string' && validation == 'email'",
                Actions = new List<RuleAction>
                {
                    new RuleAction 
                    { 
                        Type = "GenerateField",
                        Template = new
                        {
                            name = "${name}Confirmed",
                            type = "bool",
                            displayName = "${displayName}已确认",
                            defaultValue = false,
                            description = "邮箱是否已验证"
                        }
                    }
                }
            },
            new ConfigurationRule
            {
                Name = "PasswordFieldsRule",
                Description = "为密码字段生成相关字段",
                Condition = "name.Contains('password', StringComparison.OrdinalIgnoreCase)",
                Actions = new List<RuleAction>
                {
                    new RuleAction
                    {
                        Type = "GenerateFields",
                        Templates = new[]
                        {
                            new { name = "passwordHash", type = "string", maxLength = 256, hidden = true },
                            new { name = "passwordSalt", type = "string", maxLength = 128, hidden = true },
                            new { name = "passwordResetToken", type = "string", maxLength = 256, nullable = true },
                            new { name = "passwordResetTokenExpiry", type = "datetime", nullable = true },
                            new { name = "lastPasswordChangeTime", type = "datetime", nullable = true }
                        }
                    }
                }
            }
        };
        
        // 验证规则
        _rulesets["validation"] = new List<ConfigurationRule>
        {
            new ConfigurationRule
            {
                Name = "RequiredFieldValidation",
                Description = "必填字段验证",
                Condition = "required == true",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "AddValidation", ValidationRule = "Required", Message = "${displayName}不能为空" }
                }
            },
            new ConfigurationRule
            {
                Name = "StringLengthValidation",
                Description = "字符串长度验证",
                Condition = "type == 'string' && maxLength != null",
                Actions = new List<RuleAction>
                {
                    new RuleAction { Type = "AddValidation", ValidationRule = "MaxLength", Value = "${maxLength}", Message = "${displayName}长度不能超过${maxLength}个字符" }
                }
            }
        };
    }
    
    /// <summary>
    /// 根据上下文获取配置建议（基于规则，非AI）
    /// </summary>
    public async Task<ConfigurationSuggestions> GetSuggestionsAsync(ConfigurationContext context)
    {
        var suggestions = new ConfigurationSuggestions();
        
        // 1. 根据字段名推断类型
        if (!string.IsNullOrEmpty(context.CurrentFieldName))
        {
            var typeInference = InferFieldType(context.CurrentFieldName);
            if (typeInference != null)
            {
                suggestions.Items.Add(new Suggestion
                {
                    Type = "FieldType",
                    Title = $"推荐字段类型：{typeInference.Type}",
                    Description = $"根据字段名 '{context.CurrentFieldName}' 推断",
                    Confidence = typeInference.Confidence,
                    ApplyAction = () => context.SetFieldType(typeInference.Type)
                });
            }
        }
        
        // 2. 根据已有字段推荐关联字段
        if (context.ExistingFields?.Any() == true)
        {
            var relatedFields = GenerateRelatedFields(context.ExistingFields);
            foreach (var field in relatedFields)
            {
                suggestions.Items.Add(new Suggestion
                {
                    Type = "RelatedField",
                    Title = $"建议添加关联字段：{field.Name}",
                    Description = field.Description,
                    Confidence = 0.7,
                    ApplyAction = () => context.AddField(field)
                });
            }
        }
        
        // 3. 基于最佳实践的建议
        suggestions.Items.AddRange(GetBestPracticeSuggestions(context));
        
        return suggestions;
    }
    
    /// <summary>
    /// 基于规则推断字段类型
    /// </summary>
    private FieldTypeInference InferFieldType(string fieldName)
    {
        foreach (var rule in _rulesets["field-type-inference"])
        {
            if (EvaluateCondition(rule.Condition, new { name = fieldName }))
            {
                var inference = new FieldTypeInference();
                foreach (var action in rule.Actions)
                {
                    if (action.Property == "type")
                        inference.Type = action.Value.ToString();
                    else if (action.Property == "validation")
                        inference.Validation = action.Value.ToString();
                }
                inference.Confidence = 0.8; // 基于规则的置信度
                return inference;
            }
        }
        
        // 默认推断为string类型
        return new FieldTypeInference
        {
            Type = "string",
            Confidence = 0.3
        };
    }
    
    /// <summary>
    /// 生成关联字段
    /// </summary>
    private List<FieldDefinition> GenerateRelatedFields(List<FieldDefinition> existingFields)
    {
        var relatedFields = new List<FieldDefinition>();
        
        foreach (var field in existingFields)
        {
            foreach (var rule in _rulesets["related-fields"])
            {
                if (EvaluateCondition(rule.Condition, field))
                {
                    // 执行规则动作生成关联字段
                    var generatedFields = ExecuteFieldGenerationRule(rule, field);
                    relatedFields.AddRange(generatedFields);
                }
            }
        }
        
        return relatedFields;
    }
    
    /// <summary>
    /// 获取最佳实践建议
    /// </summary>
    private List<Suggestion> GetBestPracticeSuggestions(ConfigurationContext context)
    {
        var suggestions = new List<Suggestion>();
        
        // 检查是否启用审计
        if (!context.Configuration.Auditing)
        {
            suggestions.Add(new Suggestion
            {
                Type = "BestPractice",
                Title = "建议启用审计功能",
                Description = "审计功能可以自动记录数据的创建时间、修改时间和操作人信息",
                Confidence = 0.9,
                ApplyAction = () => context.Configuration.Auditing = true
            });
        }
        
        // 检查是否启用软删除
        if (!context.Configuration.SoftDelete)
        {
            suggestions.Add(new Suggestion
            {
                Type = "BestPractice",
                Title = "建议启用软删除",
                Description = "软删除可以避免数据误删，保留删除记录便于恢复",
                Confidence = 0.85,
                ApplyAction = () => context.Configuration.SoftDelete = true
            });
        }
        
        // 检查主键配置
        if (!context.ExistingFields?.Any(f => f.Name.Equals("Id", StringComparison.OrdinalIgnoreCase)) == true)
        {
            suggestions.Add(new Suggestion
            {
                Type = "BestPractice",
                Title = "缺少主键字段",
                Description = "建议添加Id字段作为主键",
                Confidence = 1.0,
                ApplyAction = () => context.AddField(new FieldDefinition
                {
                    Name = "Id",
                    Type = "guid",
                    Required = true,
                    IsPrimaryKey = true,
                    Description = "主键"
                })
            });
        }
        
        return suggestions;
    }
}

/// <summary>
/// 配置模板
/// </summary>
public class ConfigurationTemplate
{
    public string Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public string Category { get; set; }
    public string Version { get; set; }
    public JsonSchema Schema { get; set; }
    public List<ConfigurationExample> Examples { get; set; } = new();
    public string QuickStart { get; set; }
    public Dictionary<string, object> DefaultValues { get; set; } = new();
    public List<string> Tags { get; set; } = new();
}

/// <summary>
/// 配置示例
/// </summary>
public class ConfigurationExample
{
    public string Name { get; set; }
    public string Description { get; set; }
    public string Content { get; set; }
    public string Language { get; set; } = "json";
    public List<string> Highlights { get; set; } = new();
    public Dictionary<string, string> Annotations { get; set; } = new();
}
```

### 1.2 前端模板辅助组件

```vue
<!-- src/components/template/TemplateAssistant.vue -->
<template>
  <div class="template-assistant">
    <!-- 模板选择器 -->
    <div class="template-selector">
      <div class="selector-header">
        <h3>选择配置模板</h3>
        <span class="hint">选择一个模板开始配置，或从示例中学习</span>
      </div>
      
      <div class="template-categories">
        <div v-for="category in templateCategories" :key="category.id"
             class="category-card"
             :class="{ active: selectedCategory === category.id }"
             @click="selectCategory(category.id)">
          <Icon :name="category.icon" />
          <span>{{ category.name }}</span>
          <Badge>{{ category.count }}</Badge>
        </div>
      </div>
      
      <div class="template-list">
        <div v-for="template in filteredTemplates" :key="template.id"
             class="template-item"
             :class="{ selected: selectedTemplate?.id === template.id }"
             @click="selectTemplate(template)">
          <div class="template-header">
            <Icon :name="template.icon" />
            <div class="template-info">
              <h4>{{ template.name }}</h4>
              <p>{{ template.description }}</p>
            </div>
          </div>
          
          <div class="template-tags">
            <Tag v-for="tag in template.tags" :key="tag" size="small">{{ tag }}</Tag>
          </div>
          
          <div class="template-actions">
            <Button size="small" @click.stop="previewTemplate(template)">
              <Icon name="eye" /> 预览
            </Button>
            <Button size="small" type="primary" @click.stop="useTemplate(template)">
              <Icon name="check" /> 使用
            </Button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 配置编辑器 -->
    <div class="config-editor">
      <div class="editor-header">
        <div class="editor-title">
          <h3>配置编辑器</h3>
          <span v-if="selectedTemplate" class="template-name">
            当前模板：{{ selectedTemplate.name }}
          </span>
        </div>
        
        <div class="editor-actions">
          <ButtonGroup>
            <Button @click="formatJson">
              <Icon name="format" /> 格式化
            </Button>
            <Button @click="validateConfig">
              <Icon name="check-circle" /> 验证
            </Button>
            <Button @click="clearEditor">
              <Icon name="trash" /> 清空
            </Button>
          </ButtonGroup>
        </div>
      </div>
      
      <!-- Monaco编辑器 -->
      <div class="editor-container">
        <MonacoEditor
          v-model="configContent"
          language="json"
          :theme="editorTheme"
          :options="editorOptions"
          @change="onConfigChange"
        />
        
        <!-- 实时错误提示 -->
        <transition name="slide-up">
          <div v-if="validationErrors.length > 0" class="validation-panel">
            <div class="validation-header">
              <Icon name="alert-circle" class="error" />
              <span>发现 {{ validationErrors.length }} 个问题</span>
            </div>
            <div class="validation-errors">
              <div v-for="error in validationErrors" :key="error.path"
                   class="error-item"
                   @click="goToError(error)">
                <Icon name="x-circle" class="error-icon" />
                <div class="error-content">
                  <div class="error-path">{{ error.path }}</div>
                  <div class="error-message">{{ error.message }}</div>
                </div>
                <div class="error-line">行 {{ error.line }}</div>
              </div>
            </div>
          </div>
        </transition>
      </div>
      
      <!-- 智能提示面板 -->
      <div class="suggestion-panel">
        <div class="panel-header">
          <Icon name="lightbulb" />
          <span>智能提示</span>
          <Switch v-model="enableSuggestions" size="small">启用</Switch>
        </div>
        
        <div v-if="enableSuggestions" class="suggestions">
          <!-- 字段类型推荐 -->
          <div v-if="currentField" class="suggestion-section">
            <h5>字段类型推荐</h5>
            <div class="type-suggestions">
              <div v-for="type in suggestedTypes" :key="type.value"
                   class="type-option"
                   :class="{ recommended: type.recommended }"
                   @click="applyFieldType(type.value)">
                <span class="type-name">{{ type.label }}</span>
                <span v-if="type.recommended" class="badge">推荐</span>
                <span class="type-desc">{{ type.description }}</span>
              </div>
            </div>
          </div>
          
          <!-- 关联字段建议 -->
          <div v-if="relatedFieldSuggestions.length > 0" class="suggestion-section">
            <h5>建议添加的关联字段</h5>
            <div class="related-fields">
              <div v-for="field in relatedFieldSuggestions" :key="field.name"
                   class="related-field">
                <Checkbox v-model="field.selected">
                  <span class="field-name">{{ field.name }}</span>
                  <span class="field-type">({{ field.type }})</span>
                </Checkbox>
                <span class="field-desc">{{ field.description }}</span>
              </div>
            </div>
            <Button size="small" @click="addSelectedFields">添加选中字段</Button>
          </div>
          
          <!-- 最佳实践提示 -->
          <div class="suggestion-section">
            <h5>最佳实践</h5>
            <Alert v-for="tip in bestPractices" :key="tip.id"
                   :type="tip.type"
                   :closable="false">
              <template #icon>
                <Icon :name="tip.icon" />
              </template>
              <div class="tip-content">
                <div class="tip-title">{{ tip.title }}</div>
                <div class="tip-desc">{{ tip.description }}</div>
                <Button v-if="tip.action" size="mini" @click="tip.action">
                  {{ tip.actionText }}
                </Button>
              </div>
            </Alert>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 示例面板 -->
    <div class="example-panel">
      <Tabs v-model="activeExampleTab">
        <TabPane label="配置示例" name="examples">
          <div class="example-list">
            <div v-for="example in currentExamples" :key="example.id"
                 class="example-item">
              <div class="example-header">
                <h4>{{ example.name }}</h4>
                <Button size="mini" @click="useExample(example)">使用此示例</Button>
              </div>
              
              <div class="example-desc">{{ example.description }}</div>
              
              <!-- 带注释的示例代码 -->
              <div class="example-code">
                <CodeHighlight
                  :code="example.content"
                  :language="example.language"
                  :line-numbers="true"
                  :highlights="example.highlights"
                />
                
                <!-- 代码注释说明 -->
                <div v-for="(annotation, line) in example.annotations" :key="line"
                     class="code-annotation"
                     :style="{ top: `${line * 20}px` }">
                  <Icon name="info-circle" />
                  <span>{{ annotation }}</span>
                </div>
              </div>
              
              <div class="example-actions">
                <Button size="small" @click="copyExample(example)">
                  <Icon name="copy" /> 复制
                </Button>
                <Button size="small" @click="viewExampleDetails(example)">
                  <Icon name="book" /> 详细说明
                </Button>
              </div>
            </div>
          </div>
        </TabPane>
        
        <TabPane label="快速入门" name="quickstart">
          <div class="quickstart-content">
            <Markdown :content="currentTemplate?.quickStart" />
          </div>
        </TabPane>
        
        <TabPane label="字段参考" name="reference">
          <div class="reference-content">
            <Table :data="fieldReference" :columns="referenceColumns">
              <template #type="{ row }">
                <Tag>{{ row.type }}</Tag>
              </template>
              <template #required="{ row }">
                <Icon :name="row.required ? 'check' : 'x'" 
                      :class="row.required ? 'success' : 'muted'" />
              </template>
            </Table>
          </div>
        </TabPane>
      </Tabs>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, watch, onMounted } from 'vue';
import { useTemplateEngine } from '@/composables/useTemplateEngine';
import { useRuleEngine } from '@/composables/useRuleEngine';
import { useValidation } from '@/composables/useValidation';
import * as monaco from 'monaco-editor';

// 模板引擎
const { 
  templates,
  loadTemplate,
  getExamples,
  getFieldReference 
} = useTemplateEngine();

// 规则引擎
const {
  inferFieldType,
  generateRelatedFields,
  getBestPractices
} = useRuleEngine();

// 验证服务
const {
  validateJson,
  validateAgainstSchema
} = useValidation();

// 状态
const selectedCategory = ref('domain');
const selectedTemplate = ref(null);
const configContent = ref('');
const validationErrors = ref([]);
const enableSuggestions = ref(true);
const currentField = ref(null);
const activeExampleTab = ref('examples');

// 模板分类
const templateCategories = [
  { id: 'domain', name: '领域模型', icon: 'cube', count: 5 },
  { id: 'application', name: '应用服务', icon: 'layers', count: 8 },
  { id: 'api', name: 'API接口', icon: 'globe', count: 6 },
  { id: 'ui', name: '界面配置', icon: 'layout', count: 10 },
  { id: 'workflow', name: '工作流', icon: 'git-branch', count: 4 }
];

// 过滤后的模板
const filteredTemplates = computed(() => {
  return templates.value.filter(t => t.category === selectedCategory.value);
});

// 当前示例
const currentExamples = computed(() => {
  return selectedTemplate.value?.examples || [];
});

// 字段类型建议
const suggestedTypes = computed(() => {
  if (!currentField.value) return [];
  
  const fieldName = currentField.value.name;
  const inferred = inferFieldType(fieldName);
  
  return [
    { value: 'string', label: '字符串', description: '文本内容', recommended: inferred === 'string' },
    { value: 'int', label: '整数', description: '整数数字', recommended: inferred === 'int' },
    { value: 'decimal', label: '小数', description: '带小数的数字', recommended: inferred === 'decimal' },
    { value: 'bool', label: '布尔', description: '是/否', recommended: inferred === 'bool' },
    { value: 'datetime', label: '日期时间', description: '日期和时间', recommended: inferred === 'datetime' },
    { value: 'guid', label: 'GUID', description: '唯一标识符', recommended: inferred === 'guid' }
  ];
});

// 关联字段建议
const relatedFieldSuggestions = ref([]);

// 最佳实践
const bestPractices = computed(() => {
  return getBestPractices(configContent.value);
});

// 编辑器选项
const editorOptions = {
  automaticLayout: true,
  formatOnPaste: true,
  formatOnType: true,
  fontSize: 14,
  lineNumbers: 'on',
  minimap: { enabled: false },
  scrollBeyondLastLine: false,
  wordWrap: 'on',
  folding: true,
  foldingStrategy: 'indentation',
  showFoldingControls: 'always',
  bracketPairColorization: { enabled: true },
  guides: {
    bracketPairs: true,
    indentation: true
  },
  suggest: {
    showFields: true,
    showFunctions: true,
    showConstants: true,
    showClasses: true,
    showInterfaces: true
  }
};

// 选择模板
const selectTemplate = (template) => {
  selectedTemplate.value = template;
  
  // 加载模板默认值
  if (template.defaultValues) {
    configContent.value = JSON.stringify(template.defaultValues, null, 2);
  }
  
  // 显示快速入门
  showNotification({
    type: 'info',
    title: '模板已加载',
    message: '查看右侧的快速入门指南了解如何使用此模板'
  });
};

// 使用示例
const useExample = (example) => {
  configContent.value = example.content;
  
  // 滚动到编辑器
  document.querySelector('.editor-container')?.scrollIntoView({ behavior: 'smooth' });
  
  showNotification({
    type: 'success',
    title: '示例已加载',
    message: '您可以基于此示例进行修改'
  });
};

// 验证配置
const validateConfig = async () => {
  try {
    const json = JSON.parse(configContent.value);
    
    if (selectedTemplate.value?.schema) {
      const errors = await validateAgainstSchema(json, selectedTemplate.value.schema);
      validationErrors.value = errors;
      
      if (errors.length === 0) {
        showNotification({
          type: 'success',
          title: '验证通过',
          message: '配置格式正确，符合模板要求'
        });
      }
    }
  } catch (e) {
    validationErrors.value = [{
      path: 'root',
      message: `JSON格式错误: ${e.message}`,
      line: getErrorLine(e.message)
    }];
  }
};

// 配置变化时的处理
const onConfigChange = debounce(() => {
  // 实时验证
  if (enableSuggestions.value) {
    validateConfig();
  }
  
  // 更新关联字段建议
  updateRelatedFieldSuggestions();
}, 500);

// 更新关联字段建议
const updateRelatedFieldSuggestions = () => {
  try {
    const config = JSON.parse(configContent.value);
    if (config.properties) {
      relatedFieldSuggestions.value = generateRelatedFields(config.properties);
    }
  } catch (e) {
    // 忽略解析错误
  }
};

// 格式化JSON
const formatJson = () => {
  try {
    const json = JSON.parse(configContent.value);
    configContent.value = JSON.stringify(json, null, 2);
    showNotification({
      type: 'success',
      title: '格式化完成',
      message: 'JSON已格式化'
    });
  } catch (e) {
    showNotification({
      type: 'error',
      title: '格式化失败',
      message: 'JSON格式错误，无法格式化'
    });
  }
};

onMounted(() => {
  // 加载默认模板
  const defaultTemplate = templates.value.find(t => t.id === 'entity');
  if (defaultTemplate) {
    selectTemplate(defaultTemplate);
  }
  
  // 注册Monaco编辑器的JSON Schema
  if (selectedTemplate.value?.schema) {
    monaco.languages.json.jsonDefaults.setDiagnosticsOptions({
      validate: true,
      schemas: [{
        uri: 'http://myserver/config-schema.json',
        fileMatch: ['*'],
        schema: selectedTemplate.value.schema
      }]
    });
  }
});
</script>

<style lang="scss" scoped>
.template-assistant {
  display: grid;
  grid-template-columns: 300px 1fr 400px;
  height: 100vh;
  gap: 1px;
  background: var(--border-color);
  
  > div {
    background: white;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  
  .template-selector {
    border-right: 1px solid var(--border-color);
    
    .selector-header {
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      
      h3 {
        margin: 0 0 4px 0;
      }
      
      .hint {
        font-size: 12px;
        color: var(--text-secondary);
      }
    }
    
    .template-categories {
      display: flex;
      gap: 8px;
      padding: 12px;
      border-bottom: 1px solid var(--border-color);
      overflow-x: auto;
      
      .category-card {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        border: 1px solid var(--border-color);
        border-radius: 20px;
        cursor: pointer;
        white-space: nowrap;
        transition: all 0.2s;
        
        &:hover {
          border-color: var(--primary-color);
          background: var(--primary-light-bg);
        }
        
        &.active {
          background: var(--primary-color);
          color: white;
          border-color: var(--primary-color);
        }
      }
    }
    
    .template-list {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      
      .template-item {
        padding: 12px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.2s;
        
        &:hover {
          border-color: var(--primary-color);
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        &.selected {
          border-color: var(--primary-color);
          background: var(--primary-light-bg);
        }
        
        .template-header {
          display: flex;
          align-items: start;
          gap: 12px;
          margin-bottom: 8px;
          
          .template-info {
            flex: 1;
            
            h4 {
              margin: 0 0 4px 0;
            }
            
            p {
              margin: 0;
              font-size: 12px;
              color: var(--text-secondary);
            }
          }
        }
        
        .template-tags {
          display: flex;
          gap: 4px;
          margin-bottom: 8px;
        }
        
        .template-actions {
          display: flex;
          gap: 8px;
        }
      }
    }
  }
  
  .config-editor {
    display: flex;
    flex-direction: column;
    
    .editor-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      border-bottom: 1px solid var(--border-color);
      
      .editor-title {
        display: flex;
        align-items: center;
        gap: 12px;
        
        h3 {
          margin: 0;
        }
        
        .template-name {
          font-size: 12px;
          color: var(--text-secondary);
        }
      }
    }
    
    .editor-container {
      flex: 1;
      position: relative;
      
      .validation-panel {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid var(--danger-color);
        max-height: 200px;
        overflow-y: auto;
        z-index: 10;
        
        .validation-header {
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 8px 12px;
          background: var(--danger-light-bg);
          color: var(--danger-color);
          font-weight: 500;
        }
        
        .validation-errors {
          padding: 8px 0;
          
          .error-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            cursor: pointer;
            
            &:hover {
              background: var(--hover-bg);
            }
            
            .error-icon {
              color: var(--danger-color);
            }
            
            .error-content {
              flex: 1;
              
              .error-path {
                font-size: 11px;
                color: var(--text-secondary);
              }
              
              .error-message {
                font-size: 13px;
              }
            }
            
            .error-line {
              font-size: 11px;
              color: var(--text-secondary);
            }
          }
        }
      }
    }
    
    .suggestion-panel {
      border-top: 1px solid var(--border-color);
      max-height: 300px;
      overflow-y: auto;
      
      .panel-header {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 16px;
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border-color);
        position: sticky;
        top: 0;
        z-index: 1;
        
        > span {
          flex: 1;
          font-weight: 500;
        }
      }
      
      .suggestions {
        padding: 16px;
        
        .suggestion-section {
          margin-bottom: 20px;
          
          h5 {
            margin: 0 0 12px 0;
            color: var(--text-secondary);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
          }
          
          .type-suggestions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            
            .type-option {
              padding: 8px;
              border: 1px solid var(--border-color);
              border-radius: 4px;
              cursor: pointer;
              transition: all 0.2s;
              
              &:hover {
                border-color: var(--primary-color);
                background: var(--primary-light-bg);
              }
              
              &.recommended {
                border-color: var(--success-color);
                background: var(--success-light-bg);
              }
              
              .type-name {
                font-weight: 500;
                margin-right: 4px;
              }
              
              .badge {
                font-size: 10px;
                padding: 2px 6px;
                background: var(--success-color);
                color: white;
                border-radius: 10px;
              }
              
              .type-desc {
                display: block;
                font-size: 11px;
                color: var(--text-secondary);
                margin-top: 2px;
              }
            }
          }
          
          .related-fields {
            .related-field {
              padding: 8px 0;
              border-bottom: 1px solid var(--border-color);
              
              &:last-child {
                border-bottom: none;
              }
              
              .field-name {
                font-weight: 500;
              }
              
              .field-type {
                color: var(--text-secondary);
                font-size: 12px;
              }
              
              .field-desc {
                display: block;
                font-size: 12px;
                color: var(--text-secondary);
                margin-top: 4px;
                margin-left: 24px;
              }
            }
          }
        }
      }
    }
  }
  
  .example-panel {
    border-left: 1px solid var(--border-color);
    
    .example-list {
      padding: 16px;
      overflow-y: auto;
      
      .example-item {
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 12px;
        
        .example-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 8px;
          
          h4 {
            margin: 0;
          }
        }
        
        .example-desc {
          font-size: 13px;
          color: var(--text-secondary);
          margin-bottom: 12px;
        }
        
        .example-code {
          position: relative;
          margin-bottom: 12px;
          
          .code-annotation {
            position: absolute;
            right: -200px;
            width: 180px;
            padding: 4px 8px;
            background: var(--warning-light-bg);
            border: 1px solid var(--warning-color);
            border-radius: 4px;
            font-size: 11px;
            color: var(--warning-dark);
            display: none;
            
            &:hover {
              display: block;
            }
          }
        }
        
        .example-actions {
          display: flex;
          gap: 8px;
        }
      }
    }
    
    .quickstart-content,
    .reference-content {
      padding: 16px;
      overflow-y: auto;
    }
  }
}

// 动画
.slide-up-enter-active,
.slide-up-leave-active {
  transition: all 0.3s ease;
}

.slide-up-enter-from {
  transform: translateY(100%);
  opacity: 0;
}

.slide-up-leave-to {
  transform: translateY(100%);
  opacity: 0;
}
</style>
```

## 二、主题引擎（模板驱动版）

### 2.1 预设主题系统

```typescript
/**
 * 基于预设模板的主题系统
 * 无需AI，通过精心设计的主题预设实现专业效果
 */

// src/theme/ThemePresets.ts

export class ThemePresetManager {
  private themes: Map<string, ThemePreset> = new Map();
  
  constructor() {
    this.loadPresetThemes();
  }
  
  /**
   * 加载预设主题
   */
  private loadPresetThemes() {
    // 经典蓝色主题
    this.themes.set('classic-blue', {
      id: 'classic-blue',
      name: '经典蓝',
      description: '专业的企业蓝色主题',
      preview: '/themes/classic-blue.png',
      colors: {
        // 主色调
        primary: '#0078D4',        // 微软蓝
        primaryLight: '#40A6FF',
        primaryDark: '#0055A0',
        primaryAlpha10: 'rgba(0, 120, 212, 0.1)',
        primaryAlpha20: 'rgba(0, 120, 212, 0.2)',
        
        // 功能色
        success: '#107C10',
        successLight: '#5EC55E',
        successDark: '#0B5A0B',
        
        warning: '#FFB900',
        warningLight: '#FFD966',
        warningDark: '#CC9400',
        
        danger: '#D13438',
        dangerLight: '#E95C5F',
        dangerDark: '#A42327',
        
        info: '#0099BC',
        infoLight: '#4DB8D1',
        infoDark: '#007494',
        
        // 中性色
        text: '#323130',
        textSecondary: '#605E5C',
        textTertiary: '#A19F9D',
        textDisabled: '#C8C6C4',
        
        background: '#FFFFFF',
        backgroundSecondary: '#F3F2F1',
        backgroundTertiary: '#FAF9F8',
        
        border: '#EDEBE9',
        borderLight: '#F3F2F1',
        borderDark: '#D2D0CE',
        
        // 特殊色
        shadow: 'rgba(0, 0, 0, 0.08)',
        overlay: 'rgba(0, 0, 0, 0.4)'
      },
      typography: {
        fontFamily: "'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', sans-serif",
        fontFamilyMono: "'Cascadia Code', 'Consolas', monospace",
        
        // 字号体系
        fontSize: {
          xs: '11px',
          sm: '12px',
          base: '14px',
          lg: '16px',
          xl: '20px',
          '2xl': '24px',
          '3xl': '32px',
          '4xl': '42px'
        },
        
        // 行高
        lineHeight: {
          tight: 1.2,
          normal: 1.5,
          relaxed: 1.75
        },
        
        // 字重
        fontWeight: {
          light: 300,
          normal: 400,
          medium: 500,
          semibold: 600,
          bold: 700
        }
      },
      spacing: {
        xs: '4px',
        sm: '8px',
        md: '12px',
        lg: '16px',
        xl: '24px',
        '2xl': '32px',
        '3xl': '48px'
      },
      borderRadius: {
        none: '0',
        sm: '2px',
        base: '4px',
        md: '6px',
        lg: '8px',
        xl: '12px',
        full: '9999px'
      },
      shadows: {
        sm: '0 1px 2px rgba(0, 0, 0, 0.05)',
        base: '0 2px 4px rgba(0, 0, 0, 0.08)',
        md: '0 4px 8px rgba(0, 0, 0, 0.12)',
        lg: '0 8px 16px rgba(0, 0, 0, 0.15)',
        xl: '0 12px 24px rgba(0, 0, 0, 0.18)'
      },
      transitions: {
        fast: '150ms ease',
        base: '250ms ease',
        slow: '350ms ease',
        slower: '500ms ease'
      }
    });
    
    // 暗黑主题
    this.themes.set('dark-professional', {
      id: 'dark-professional',
      name: '专业暗黑',
      description: '护眼的深色主题',
      preview: '/themes/dark-professional.png',
      colors: {
        primary: '#60CDFF',
        primaryLight: '#8BD8FF',
        primaryDark: '#3DBFFF',
        
        success: '#6CCF6C',
        warning: '#FCE100',
        danger: '#FF9999',
        info: '#80D4FF',
        
        text: '#FFFFFF',
        textSecondary: '#D2D0CE',
        textTertiary: '#A19F9D',
        
        background: '#1F1F1F',
        backgroundSecondary: '#292929',
        backgroundTertiary: '#323232',
        
        border: '#3B3A39',
        borderLight: '#484644',
        borderDark: '#292827'
      }
      // ... 其他配置
    });
    
    // 更多预设主题...
  }
  
  /**
   * 应用主题
   */
  public applyTheme(themeId: string): void {
    const theme = this.themes.get(themeId);
    if (!theme) {
      throw new Error(`Theme ${themeId} not found`);
    }
    
    // 应用到CSS变量
    this.applyToCSSVariables(theme);
    
    // 保存用户选择
    localStorage.setItem('selected-theme', themeId);
    
    // 触发主题变更事件
    window.dispatchEvent(new CustomEvent('theme-changed', { detail: theme }));
  }
  
  /**
   * 应用到CSS变量
   */
  private applyToCSSVariables(theme: ThemePreset): void {
    const root = document.documentElement;
    
    // 应用颜色
    Object.entries(theme.colors).forEach(([key, value]) => {
      root.style.setProperty(`--color-${this.kebabCase(key)}`, value);
    });
    
    // 应用字体
    Object.entries(theme.typography.fontSize).forEach(([key, value]) => {
      root.style.setProperty(`--font-size-${key}`, value);
    });
    
    // 应用间距
    Object.entries(theme.spacing).forEach(([key, value]) => {
      root.style.setProperty(`--spacing-${key}`, value);
    });
    
    // 应用圆角
    Object.entries(theme.borderRadius).forEach(([key, value]) => {
      root.style.setProperty(`--radius-${key}`, value);
    });
    
    // 应用阴影
    Object.entries(theme.shadows).forEach(([key, value]) => {
      root.style.setProperty(`--shadow-${key}`, value);
    });
  }
  
  private kebabCase(str: string): string {
    return str.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();
  }
}
```

## 三、布局模板系统

### 3.1 预定义布局模板

```typescript
/**
 * 布局模板系统 - 提供多种专业布局
 */

export class LayoutTemplateSystem {
  private layouts: Map<string, LayoutTemplate> = new Map();
  
  constructor() {
    this.initializeLayouts();
  }
  
  private initializeLayouts() {
    // 经典后台布局
    this.layouts.set('admin-classic', {
      id: 'admin-classic',
      name: '经典后台',
      description: '左侧菜单 + 顶部导航的经典布局',
      preview: '/layouts/admin-classic.png',
      structure: `
<!-- 经典后台布局模板 -->
<div class="app-layout admin-classic">
  <!-- 顶部导航栏 -->
  <header class="app-header">
    <div class="header-left">
      <!-- Logo -->
      <div class="app-logo">
        <img src="/logo.png" alt="Logo">
        <span class="app-name">{{ appName }}</span>
      </div>
    </div>
    
    <div class="header-center">
      <!-- 顶部菜单（可选） -->
      <nav class="top-menu">
        <a v-for="item in topMenuItems" :key="item.id" 
           :href="item.url" 
           :class="{ active: item.active }">
          {{ item.label }}
        </a>
      </nav>
    </div>
    
    <div class="header-right">
      <!-- 搜索框 -->
      <div class="global-search">
        <input type="text" placeholder="搜索...">
        <Icon name="search" />
      </div>
      
      <!-- 通知 -->
      <div class="notifications">
        <Icon name="bell" />
        <span class="badge">3</span>
      </div>
      
      <!-- 用户菜单 -->
      <div class="user-menu">
        <img :src="user.avatar" class="user-avatar">
        <span class="user-name">{{ user.name }}</span>
        <Icon name="chevron-down" />
      </div>
    </div>
  </header>
  
  <!-- 主体容器 -->
  <div class="app-body">
    <!-- 左侧菜单 -->
    <aside class="app-sidebar" :class="{ collapsed: sidebarCollapsed }">
      <!-- 菜单切换按钮 -->
      <div class="sidebar-toggle" @click="toggleSidebar">
        <Icon :name="sidebarCollapsed ? 'menu-unfold' : 'menu-fold'" />
      </div>
      
      <!-- 菜单列表 -->
      <nav class="sidebar-menu">
        <div v-for="group in menuGroups" :key="group.id" class="menu-group">
          <div class="menu-group-title">{{ group.title }}</div>
          
          <ul class="menu-items">
            <li v-for="item in group.items" :key="item.id" 
                class="menu-item"
                :class="{ active: item.active, 'has-children': item.children }">
              
              <a :href="item.url" class="menu-link">
                <Icon :name="item.icon" class="menu-icon" />
                <span class="menu-text">{{ item.label }}</span>
                <Icon v-if="item.children" name="chevron-right" class="menu-arrow" />
              </a>
              
              <!-- 子菜单 -->
              <ul v-if="item.children && item.expanded" class="submenu">
                <li v-for="child in item.children" :key="child.id">
                  <a :href="child.url" :class="{ active: child.active }">
                    {{ child.label }}
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>
    
    <!-- 内容区域 -->
    <main class="app-content">
      <!-- 面包屑 -->
      <div class="breadcrumb">
        <a v-for="(crumb, index) in breadcrumbs" :key="index" 
           :href="crumb.url"
           :class="{ active: index === breadcrumbs.length - 1 }">
          {{ crumb.label }}
          <span v-if="index < breadcrumbs.length - 1" class="separator">/</span>
        </a>
      </div>
      
      <!-- 页面标题 -->
      <div class="page-header">
        <h1 class="page-title">{{ pageTitle }}</h1>
        <div class="page-actions">
          <slot name="page-actions">
            <!-- 页面操作按钮 -->
          </slot>
        </div>
      </div>
      
      <!-- 主要内容 -->
      <div class="page-body">
        <slot>
          <!-- 页面内容插槽 -->
        </slot>
      </div>
    </main>
  </div>
  
  <!-- 底部信息 -->
  <footer class="app-footer">
    <div class="footer-left">
      © 2024 Your Company. All rights reserved.
    </div>
    <div class="footer-right">
      Version {{ version }} | <a href="/help">帮助文档</a>
    </div>
  </footer>
</div>
`,
      styles: `
/* 经典后台布局样式 */
.admin-classic {
  display: flex;
  flex-direction: column;
  height: 100vh;
  
  /* 顶部导航 */
  .app-header {
    height: 60px;
    background: var(--color-background);
    border-bottom: 1px solid var(--color-border);
    display: flex;
    align-items: center;
    padding: 0 20px;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    
    .header-left,
    .header-center,
    .header-right {
      display: flex;
      align-items: center;
    }
    
    .header-left {
      width: 240px;
    }
    
    .header-center {
      flex: 1;
    }
    
    .header-right {
      gap: 20px;
    }
  }
  
  /* 主体 */
  .app-body {
    display: flex;
    flex: 1;
    margin-top: 60px;
    
    /* 侧边栏 */
    .app-sidebar {
      width: 240px;
      background: var(--color-background-secondary);
      border-right: 1px solid var(--color-border);
      overflow-y: auto;
      transition: width 0.3s;
      
      &.collapsed {
        width: 60px;
        
        .menu-text,
        .menu-group-title {
          display: none;
        }
      }
      
      .sidebar-menu {
        padding: 10px 0;
        
        .menu-item {
          position: relative;
          
          .menu-link {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            color: var(--color-text-secondary);
            text-decoration: none;
            transition: all 0.2s;
            
            &:hover {
              background: var(--color-primary-alpha-10);
              color: var(--color-primary);
            }
          }
          
          &.active > .menu-link {
            background: var(--color-primary-alpha-20);
            color: var(--color-primary);
            font-weight: 500;
            
            &::before {
              content: '';
              position: absolute;
              left: 0;
              top: 0;
              bottom: 0;
              width: 3px;
              background: var(--color-primary);
            }
          }
        }
      }
    }
    
    /* 内容区 */
    .app-content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: var(--color-background-tertiary);
      
      .breadcrumb {
        margin-bottom: 20px;
        font-size: 13px;
        
        a {
          color: var(--color-text-tertiary);
          text-decoration: none;
          
          &:hover {
            color: var(--color-primary);
          }
          
          &.active {
            color: var(--color-text);
            pointer-events: none;
          }
        }
        
        .separator {
          margin: 0 8px;
          color: var(--color-text-tertiary);
        }
      }
      
      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        
        .page-title {
          margin: 0;
          font-size: 24px;
          font-weight: 500;
        }
      }
      
      .page-body {
        background: var(--color-background);
        border-radius: var(--radius-lg);
        padding: 24px;
        box-shadow: var(--shadow-sm);
      }
    }
  }
  
  /* 底部 */
  .app-footer {
    height: 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    background: var(--color-background);
    border-top: 1px solid var(--color-border);
    font-size: 12px;
    color: var(--color-text-tertiary);
  }
}

/* 响应式适配 */
@media (max-width: 768px) {
  .admin-classic {
    .app-sidebar {
      position: fixed;
      left: -240px;
      top: 60px;
      bottom: 0;
      z-index: 999;
      
      &.mobile-open {
        left: 0;
      }
    }
    
    .app-content {
      margin-left: 0;
    }
  }
}
`,
      usage: `
## 使用说明

### 1. 引入布局组件
\`\`\`javascript
import AdminClassicLayout from '@/layouts/AdminClassicLayout.vue';
\`\`\`

### 2. 在页面中使用
\`\`\`vue
<template>
  <AdminClassicLayout
    :menu-groups="menuGroups"
    :breadcrumbs="breadcrumbs"
    :page-title="pageTitle">
    
    <!-- 页面操作按钮 -->
    <template #page-actions>
      <Button type="primary">新建</Button>
      <Button>导出</Button>
    </template>
    
    <!-- 页面内容 -->
    <div>
      <!-- 您的页面内容 -->
    </div>
  </AdminClassicLayout>
</template>

<script setup>
const menuGroups = [
  {
    id: 'dashboard',
    title: '仪表板',
    items: [
      { id: 'overview', label: '概览', icon: 'dashboard', url: '/dashboard' },
      { id: 'analytics', label: '分析', icon: 'chart', url: '/analytics' }
    ]
  },
  {
    id: 'management',
    title: '管理',
    items: [
      { id: 'users', label: '用户管理', icon: 'user', url: '/users' },
      { id: 'roles', label: '角色管理', icon: 'shield', url: '/roles' }
    ]
  }
];

const breadcrumbs = [
  { label: '首页', url: '/' },
  { label: '用户管理', url: '/users' },
  { label: '用户列表' }
];

const pageTitle = '用户列表';
</script>
\`\`\`

### 3. 自定义样式
您可以通过CSS变量自定义布局样式：
\`\`\`css
:root {
  --sidebar-width: 260px;  /* 侧边栏宽度 */
  --header-height: 64px;   /* 顶部高度 */
  --footer-height: 40px;   /* 底部高度 */
}
\`\`\`
`
    });
    
    // 更多布局模板...
  }
}
```

## 总结

通过这次重构，我们去除了所有AI大模型的依赖，改为基于：

### ✅ **模板驱动系统**

- 精心设计的配置模板
- 详细的注释和示例
- 完整的快速入门指南

### ✅ **规则引擎**

- 基于规则的字段类型推断
- 关联字段自动生成
- 最佳实践检查

### ✅ **预设方案**

- 多套专业主题预设
- 多种布局模板
- 开箱即用的配置

### ✅ **智能辅助**（非AI）

- 基于规则的建议
- 实时验证反馈
- 上下文感知提示

这个方案**更加务实可行**，能够立即实施，同时通过精心设计的模板和详细的引导，依然能够提供优秀的用户体验！