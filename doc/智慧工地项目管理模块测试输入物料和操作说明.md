# 智慧工地项目管理模块测试输入物料和操作说明

## 概述
本文档基于SmartAbp低代码引擎多步骤引导模块的深入代码分析，提供智慧工地系统项目管理模块的完整测试输入参数和操作步骤。该引擎采用五步式向导：系统与模块定义、实体与关系建模、业务服务与权限、UI页面与菜单配置、预览与生成。

## 第一步：系统与模块定义

### 输入参数

| 参数名称 | 输入值 | 验证规则 | 说明 |
|---------|--------|----------|------|
| 系统名称 | SmartConstruction | 必填，PascalCase格式，以字母开头 | 智慧工地系统总称 |
| 模块名称 | ProjectManagement | 必填，PascalCase格式 | 项目管理模块 |
| 显示名称 | 项目管理 | 必填，中文显示 | 菜单显示名称 |
| 模块描述 | 智慧工地项目全生命周期管理系统 | 选填 | 模块功能描述 |
| 版本号 | 1.0.0 | 必填，语义化版本格式 | 初始版本 |
| 架构模式 | CRUD | 必填 | 选择CRUD基础架构 |
| 数据库连接 | Default | 必填 | 使用默认数据库连接 |
| 数据库类型 | SQL Server | 必填 | 后端数据库类型 |
| 数据库架构 | dbo | 必填 | 数据库schema名称 |
| 功能开关 | 启用 | 必填 | 启用功能管理 |
| 默认策略 | 空 | 选填 | 功能策略配置 |
| 上级菜单 | 系统管理 | 选填 | 菜单层级位置 |
| 路由前缀 | /project | 必填 | 前端路由前缀 |
| 移动端页面 | 否 | 必填 | 不生成移动端页面 |
| 依赖模块 | 空 | 选填 | 无依赖模块 |

### 操作步骤
1. 在系统名称输入框输入：SmartConstruction
2. 在模块名称输入框输入：ProjectManagement
3. 在显示名称输入框输入：项目管理
4. 在模块描述输入框输入：智慧工地项目全生命周期管理系统
5. 版本号保持默认值：1.0.0
6. 架构模式选择：CRUD
7. 数据库连接选择：Default
8. 数据库类型选择：SQL Server
9. 数据库架构输入：dbo
10. 功能开关选择：启用
11. 上级菜单选择：系统管理
12. 路由前缀输入：/project
13. 移动端页面选择：否
14. 点击"下一步"按钮

### 验证点
- 系统名称验证：必须以字母开头，PascalCase格式
- 模块名称验证：必须以字母开头，PascalCase格式
- 版本号验证：必须符合语义化版本格式（如1.0.0）
- 路由前缀验证：必须以斜杠开头

## 第二步：实体与关系建模

### 核心实体定义

#### 1. 项目实体 (Project)

**基本配置：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 实体名称 | Project | 项目名称 |
| 显示名称 | 项目信息 | 界面显示名称 |
| 模块名称 | ProjectManagement | 所属模块 |
| 描述 | 工程项目基本信息 | 实体描述 |
| 表名 | Projects | 数据库表名 |
| 架构 | dbo | 数据库架构 |
| 命名空间 | SmartConstruction.Domain.Projects | 命名空间 |
| 基类 | AuditedAggregateRoot<Guid> | 审计聚合根 |
| 聚合根 | 是 | 作为聚合根 |
| 多租户 | 是 | 启用多租户 |
| 软删除 | 是 | 启用软删除 |

**属性定义：**
| 属性名称 | 类型 | 必填 | 主键 | 最大长度 | 描述 |
|----------|------|------|------|----------|------|
| Id | GUID | 是 | 是 | - | 项目唯一标识 |
| ProjectCode | String | 是 | 否 | 50 | 项目编号 |
| ProjectName | String | 是 | 否 | 200 | 项目名称 |
| ProjectType | String | 是 | 否 | 50 | 项目类型（住宅、商业、工业） |
| ConstructionUnit | String | 是 | 否 | 200 | 建设单位 |
| DesignUnit | String | 是 | 否 | 200 | 设计单位 |
| SupervisionUnit | String | 是 | 否 | 200 | 监理单位 |
| ConstructionUnit | String | 是 | 否 | 200 | 施工单位 |
| ContractAmount | Decimal | 是 | 否 | - | 合同金额（万元） |
| StartDate | DateTime | 是 | 否 | - | 开工日期 |
| EndDate | DateTime | 是 | 否 | - | 竣工日期 |
| ProjectAddress | String | 是 | 否 | 500 | 项目地址 |
| ProjectStatus | String | 是 | 否 | 20 | 项目状态（筹备、在建、竣工） |
| SafetyLevel | String | 是 | 否 | 20 | 安全等级 |
| QualityLevel | String | 是 | 否 | 20 | 质量等级 |
| EnvironmentalLevel | String | 是 | 否 | 20 | 环保等级 |
| ManagerName | String | 是 | 否 | 50 | 项目经理姓名 |
| ManagerPhone | String | 是 | 否 | 20 | 项目经理电话 |
| TechnicalDirector | String | 是 | 否 | 50 | 技术负责人 |
| SafetyDirector | String | 是 | 否 | 50 | 安全负责人 |
| Latitude | Decimal | 否 | 否 | - | 纬度坐标 |
| Longitude | Decimal | 否 | 否 | - | 经度坐标 |
| Description | String | 否 | 否 | 2000 | 项目描述 |
| Remark | String | 否 | 否 | 500 | 备注信息 |

#### 2. 施工计划实体 (ConstructionPlan)

**基本配置：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 实体名称 | ConstructionPlan | 施工计划实体 |
| 显示名称 | 施工计划 | 界面显示名称 |
| 模块名称 | ProjectManagement | 所属模块 |
| 描述 | 项目施工进度计划管理 | 实体描述 |
| 表名 | ConstructionPlans | 数据库表名 |
| 架构 | dbo | 数据库架构 |
| 命名空间 | SmartConstruction.Domain.Plans | 命名空间 |
| 基类 | AuditedEntity<Guid> | 审计实体 |
| 聚合根 | 否 | 非聚合根 |
| 多租户 | 是 | 启用多租户 |
| 软删除 | 是 | 启用软删除 |

**属性定义：**
| 属性名称 | 类型 | 必填 | 主键 | 最大长度 | 描述 |
|----------|------|------|------|----------|------|
| Id | GUID | 是 | 是 | - | 计划唯一标识 |
| ProjectId | GUID | 是 | 否 | - | 关联项目ID |
| PlanCode | String | 是 | 否 | 50 | 计划编号 |
| PlanName | String | 是 | 否 | 200 | 计划名称 |
| PlanType | String | 是 | 否 | 50 | 计划类型（总计划、月计划、周计划） |
| StartDate | DateTime | 是 | 否 | - | 计划开始日期 |
| EndDate | DateTime | 是 | 否 | - | 计划结束日期 |
| Duration | Number | 是 | 否 | - | 计划工期（天） |
| Weight | Decimal | 是 | 否 | - | 权重比例 |
| PredecessorTask | String | 否 | 否 | 500 | 前置任务 |
| SuccessorTask | String | 否 | 否 | 500 | 后续任务 |
| CriticalPath | Boolean | 是 | 否 | - | 是否关键路径 |
| Milestone | Boolean | 是 | 否 | - | 是否里程碑 |
| CompletionRate | Decimal | 是 | 否 | - | 完成率 |
| Status | String | 是 | 否 | 20 | 计划状态 |
| ResponsiblePerson | String | 是 | 否 | 50 | 负责人 |
| Description | String | 否 | 否 | 1000 | 计划描述 |

#### 3. 质量检查实体 (QualityCheck)

**基本配置：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 实体名称 | QualityCheck | 质量检查实体 |
| 显示名称 | 质量检查 | 界面显示名称 |
| 模块名称 | ProjectManagement | 所属模块 |
| 描述 | 项目质量检查记录管理 | 实体描述 |
| 表名 | QualityChecks | 数据库表名 |
| 架构 | dbo | 数据库架构 |
| 命名空间 | SmartConstruction.Domain.Quality | 命名空间 |
| 基类 | AuditedEntity<Guid> | 审计实体 |
| 聚合根 | 否 | 非聚合根 |
| 多租户 | 是 | 启用多租户 |
| 软删除 | 是 | 启用软删除 |

**属性定义：**
| 属性名称 | 类型 | 必填 | 主键 | 最大长度 | 描述 |
|----------|------|------|------|----------|------|
| Id | GUID | 是 | 是 | - | 检查唯一标识 |
| ProjectId | GUID | 是 | 否 | - | 关联项目ID |
| PlanId | GUID | 是 | 否 | - | 关联计划ID |
| CheckCode | String | 是 | 否 | 50 | 检查编号 |
| CheckItem | String | 是 | 否 | 200 | 检查项目 |
| CheckType | String | 是 | 否 | 50 | 检查类型（材料、工艺、成品） |
| CheckDate | DateTime | 是 | 否 | - | 检查日期 |
| CheckResult | String | 是 | 否 | 20 | 检查结果（合格、不合格） |
| CheckStandard | String | 是 | 否 | 500 | 检查标准 |
| CheckMethod | String | 是 | 否 | 500 | 检查方法 |
| Checker | String | 是 | 否 | 50 | 检查人员 |
| QualityLevel | String | 是 | 否 | 20 | 质量等级 |
| IssueDescription | String | 否 | 否 | 1000 | 问题描述 |
| RectificationMeasures | String | 否 | 否 | 1000 | 整改措施 |
| RectificationDeadline | DateTime | 否 | 否 | - | 整改期限 |
| RectificationStatus | String | 否 | 否 | 20 | 整改状态 |
| Remark | String | 否 | 否 | 500 | 备注 |

### 实体关系定义

#### 1. 项目-施工计划关系
- **关系类型**：一对多 (OneToMany)
- **源实体**：Project
- **目标实体**：ConstructionPlan
- **源属性**：Plans
- **目标属性**：Project
- **必填**：是
- **级联删除**：是

#### 2. 项目-质量检查关系
- **关系类型**：一对多 (OneToMany)
- **源实体**：Project
- **目标实体**：QualityCheck
- **源属性**：QualityChecks
- **目标属性**：Project
- **必填**：是
- **级联删除**：是

#### 3. 施工计划-质量检查关系
- **关系类型**：一对多 (OneToMany)
- **源实体**：ConstructionPlan
- **目标实体**：QualityCheck
- **源属性**：QualityChecks
- **目标属性**：Plan
- **必填**：否
- **级联删除**：否

### 操作步骤

#### 创建项目实体
1. 点击"添加实体"按钮
2. 在实体名称输入：Project
3. 在显示名称输入：项目信息
4. 在模块名称输入：ProjectManagement
5. 在描述输入：工程项目基本信息
6. 在表名输入：Projects
7. 在架构输入：dbo
8. 在命名空间输入：SmartConstruction.Domain.Projects
9. 在基类输入：AuditedAggregateRoot<Guid>
10. 勾选：聚合根、多租户、软删除
11. 拖拽属性到设计画布，按属性定义表创建所有字段
12. 设置每个属性的验证规则（必填、最大长度等）

#### 创建施工计划实体
1. 点击"添加实体"按钮
2. 重复上述步骤，创建ConstructionPlan实体
3. 设置所有必填属性
4. 配置属性验证规则

#### 创建质量检查实体
1. 点击"添加实体"按钮
2. 重复上述步骤，创建QualityCheck实体
3. 设置所有必填属性
4. 配置属性验证规则

#### 定义实体关系
1. 切换到"关系"标签页
2. 点击"添加关系"按钮
3. 按关系定义表创建所有关系
4. 设置关系类型、级联删除等属性

#### 数据库导入（可选）
1. 点击"导入数据库"按钮
2. 选择现有数据库连接
3. 选择要导入的表
4. 映射字段类型和关系

#### SQL导入（可选）
1. 点击"导入SQL"按钮
2. 粘贴完整的CREATE TABLE语句

**项目表SQL：**
```sql
-- 项目信息表
CREATE TABLE Projects (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    ProjectCode NVARCHAR(50) NOT NULL,
    ProjectName NVARCHAR(200) NOT NULL,
    ProjectType NVARCHAR(50) NOT NULL,
    ConstructionUnit NVARCHAR(200) NOT NULL,
    DesignUnit NVARCHAR(200) NOT NULL,
    SupervisionUnit NVARCHAR(200) NOT NULL,
    ConstructionUnit NVARCHAR(200) NOT NULL,
    ContractAmount DECIMAL(18,2) NOT NULL,
    StartDate DATETIME2 NOT NULL,
    EndDate DATETIME2 NOT NULL,
    ProjectAddress NVARCHAR(500) NOT NULL,
    ProjectStatus NVARCHAR(20) NOT NULL,
    SafetyLevel NVARCHAR(20) NOT NULL,
    QualityLevel NVARCHAR(20) NOT NULL,
    EnvironmentalLevel NVARCHAR(20) NOT NULL,
    ManagerName NVARCHAR(50) NOT NULL,
    ManagerPhone NVARCHAR(20) NOT NULL,
    TechnicalDirector NVARCHAR(50) NOT NULL,
    SafetyDirector NVARCHAR(50) NOT NULL,
    Latitude DECIMAL(9,6) NULL,
    Longitude DECIMAL(9,6) NULL,
    Description NVARCHAR(2000) NULL,
    Remark NVARCHAR(500) NULL,
    CreationTime DATETIME2 DEFAULT GETUTCDATE(),
    CreatorId UNIQUEIDENTIFIER NULL,
    LastModificationTime DATETIME2 NULL,
    LastModifierId UNIQUEIDENTIFIER NULL,
    IsDeleted BIT DEFAULT 0,
    DeleterId UNIQUEIDENTIFIER NULL,
    DeletionTime DATETIME2 NULL,
    TenantId UNIQUEIDENTIFIER NULL
);

-- 创建索引
CREATE INDEX IX_Projects_ProjectCode ON Projects(ProjectCode);
CREATE INDEX IX_Projects_ProjectName ON Projects(ProjectName);
CREATE INDEX IX_Projects_ProjectStatus ON Projects(ProjectStatus);
CREATE INDEX IX_Projects_TenantId ON Projects(TenantId);
```

**施工计划表SQL：**
```sql
-- 施工计划表
CREATE TABLE ConstructionPlans (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    ProjectId UNIQUEIDENTIFIER NOT NULL,
    PlanCode NVARCHAR(50) NOT NULL,
    PlanName NVARCHAR(200) NOT NULL,
    PlanType NVARCHAR(50) NOT NULL,
    StartDate DATETIME2 NOT NULL,
    EndDate DATETIME2 NOT NULL,
    Duration INT NOT NULL,
    Weight DECIMAL(5,2) NOT NULL,
    PredecessorTask NVARCHAR(500) NULL,
    SuccessorTask NVARCHAR(500) NULL,
    CriticalPath BIT NOT NULL DEFAULT 0,
    Milestone BIT NOT NULL DEFAULT 0,
    CompletionRate DECIMAL(5,2) NOT NULL DEFAULT 0,
    Status NVARCHAR(20) NOT NULL,
    ResponsiblePerson NVARCHAR(50) NOT NULL,
    Description NVARCHAR(1000) NULL,
    CreationTime DATETIME2 DEFAULT GETUTCDATE(),
    CreatorId UNIQUEIDENTIFIER NULL,
    LastModificationTime DATETIME2 NULL,
    LastModifierId UNIQUEIDENTIFIER NULL,
    IsDeleted BIT DEFAULT 0,
    DeleterId UNIQUEIDENTIFIER NULL,
    DeletionTime DATETIME2 NULL,
    TenantId UNIQUEIDENTIFIER NULL,
    CONSTRAINT FK_ConstructionPlans_Projects FOREIGN KEY (ProjectId) REFERENCES Projects(Id) ON DELETE CASCADE
);

-- 创建索引
CREATE INDEX IX_ConstructionPlans_ProjectId ON ConstructionPlans(ProjectId);
CREATE INDEX IX_ConstructionPlans_PlanCode ON ConstructionPlans(PlanCode);
CREATE INDEX IX_ConstructionPlans_Status ON ConstructionPlans(Status);
CREATE INDEX IX_ConstructionPlans_TenantId ON ConstructionPlans(TenantId);
```

**质量检查表SQL：**
```sql
-- 质量检查表
CREATE TABLE QualityChecks (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    ProjectId UNIQUEIDENTIFIER NOT NULL,
    PlanId UNIQUEIDENTIFIER NULL,
    CheckCode NVARCHAR(50) NOT NULL,
    CheckItem NVARCHAR(200) NOT NULL,
    CheckType NVARCHAR(50) NOT NULL,
    CheckDate DATETIME2 NOT NULL,
    CheckResult NVARCHAR(20) NOT NULL,
    CheckStandard NVARCHAR(500) NOT NULL,
    CheckMethod NVARCHAR(500) NOT NULL,
    Checker NVARCHAR(50) NOT NULL,
    QualityLevel NVARCHAR(20) NOT NULL,
    IssueDescription NVARCHAR(1000) NULL,
    RectificationMeasures NVARCHAR(1000) NULL,
    RectificationDeadline DATETIME2 NULL,
    RectificationStatus NVARCHAR(20) NULL,
    Remark NVARCHAR(500) NULL,
    CreationTime DATETIME2 DEFAULT GETUTCDATE(),
    CreatorId UNIQUEIDENTIFIER NULL,
    LastModificationTime DATETIME2 NULL,
    LastModifierId UNIQUEIDENTIFIER NULL,
    IsDeleted BIT DEFAULT 0,
    DeleterId UNIQUEIDENTIFIER NULL,
    DeletionTime DATETIME2 NULL,
    TenantId UNIQUEIDENTIFIER NULL,
    CONSTRAINT FK_QualityChecks_Projects FOREIGN KEY (ProjectId) REFERENCES Projects(Id) ON DELETE CASCADE,
    CONSTRAINT FK_QualityChecks_ConstructionPlans FOREIGN KEY (PlanId) REFERENCES ConstructionPlans(Id) ON DELETE SET NULL
);

-- 创建索引
CREATE INDEX IX_QualityChecks_ProjectId ON QualityChecks(ProjectId);
CREATE INDEX IX_QualityChecks_PlanId ON QualityChecks(PlanId);
CREATE INDEX IX_QualityChecks_CheckCode ON QualityChecks(CheckCode);
CREATE INDEX IX_QualityChecks_CheckResult ON QualityChecks(CheckResult);
CREATE INDEX IX_QualityChecks_CheckDate ON QualityChecks(CheckDate);
CREATE INDEX IX_QualityChecks_TenantId ON QualityChecks(TenantId);
```

3. 点击"解析SQL"按钮验证语法
4. 点击"导入"按钮执行导入
5. 系统自动识别表结构和关系
6. 验证导入结果并调整映射关系

### 验证点
- 实体名称验证：PascalCase格式，以字母开头
- 属性名称验证：符合命名规范
- 关系完整性：外键关系正确配置
- 数据类型映射：C#类型正确转换

## 第三步：业务服务与权限

### 权限配置

#### 基础CRUD权限（自动生成）
系统会自动为每个实体生成基础CRUD权限：
- Project.Create、Project.Read、Project.Update、Project.Delete
- ConstructionPlan.Create、ConstructionPlan.Read、ConstructionPlan.Update、ConstructionPlan.Delete
- QualityCheck.Create、QualityCheck.Read、QualityCheck.Update、QualityCheck.Delete

#### 自定义权限动作

| 权限名称 | 实体 | 动作 | 显示名称 | 说明 |
|----------|------|------|----------|------|
| 项目导出 | Project | Export | 导出项目 | 导出项目数据 |
| 项目导入 | Project | Import | 导入项目 | 导入项目数据 |
| 计划审批 | ConstructionPlan | Approve | 审批计划 | 审批施工计划 |
| 计划拒绝 | ConstructionPlan | Reject | 拒绝计划 | 拒绝施工计划 |
| 质量报告 | QualityCheck | Report | 质量报告 | 生成质量检查报告 |
| 整改跟踪 | QualityCheck | Track | 整改跟踪 | 跟踪整改情况 |

#### 权限组配置

**管理员权限组：**
- 包含所有实体的所有权限
- 包含所有自定义权限动作

**项目经理权限组：**
- Project.Read、Project.Update（项目查看和更新）
- ConstructionPlan.*（施工计划所有权限）
- QualityCheck.Read、QualityCheck.Create（质量检查查看和创建）

**质检员权限组：**
- Project.Read（项目查看）
- ConstructionPlan.Read（施工计划查看）
- QualityCheck.*（质量检查所有权限）

**施工员权限组：**
- Project.Read（项目查看）
- ConstructionPlan.Read、ConstructionPlan.Update（施工计划查看和更新）
- QualityCheck.Read（质量检查查看）

### 操作步骤

#### 配置自定义权限
1. 在"实体"下拉框选择：Project
2. 在"动作"输入框输入：Export
3. 在"显示名称"输入框输入：导出项目
4. 点击"添加权限"按钮
5. 重复上述步骤，添加所有自定义权限

#### 配置权限组
1. 在权限组列表中，点击"管理员"组
2. 勾选所有权限复选框
3. 点击"项目经理"权限组
4. 勾选相应的权限复选框
5. 重复上述步骤，配置所有权限组

#### 批量操作
1. 点击"全选"按钮，为所有实体启用基础CRUD权限
2. 取消选择不需要的权限
3. 点击"反选"按钮，快速切换权限状态

### 验证点
- 权限命名规范：符合PascalCase格式
- 权限冲突检查：避免重复权限
- 权限完整性：覆盖所有业务场景
- 角色权限映射：正确配置角色权限关系

## 第四步：UI页面与菜单配置

### 菜单配置

#### 主菜单结构
```
智慧工地系统
├── 系统管理
│   └── 项目管理 (ProjectManagement)
│       ├── 项目信息 (Project)
│       ├── 施工计划 (ConstructionPlan)
│       └── 质量检查 (QualityCheck)
```

#### 菜单项详细配置

**项目管理主菜单：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 菜单ID | menu-project-management | 唯一标识 |
| 菜单标签 | 项目管理 | 显示名称 |
| 父级菜单 | 系统管理 | 上级菜单 |
| 图标 | project | 菜单图标 |
| 排序 | 100 | 菜单排序 |
| 路径 | /project | 路由路径 |

**项目信息子菜单：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 菜单ID | menu-project-info | 唯一标识 |
| 菜单标签 | 项目信息 | 显示名称 |
| 父级菜单 | 项目管理 | 上级菜单 |
| 图标 | info | 菜单图标 |
| 排序 | 10 | 菜单排序 |
| 路径 | /project/list | 路由路径 |

**施工计划子菜单：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 菜单ID | menu-construction-plan | 唯一标识 |
| 菜单标签 | 施工计划 | 显示名称 |
| 父级菜单 | 项目管理 | 上级菜单 |
| 图标 | calendar | 菜单图标 |
| 排序 | 20 | 菜单排序 |
| 路径 | /project/plan | 路由路径 |

**质量检查子菜单：**
| 参数 | 输入值 | 说明 |
|------|--------|------|
| 菜单ID | menu-quality-check | 唯一标识 |
| 菜单标签 | 质量检查 | 显示名称 |
| 父级菜单 | 项目管理 | 上级菜单 |
| 图标 | check-circle | 菜单图标 |
| 排序 | 30 | 菜单排序 |
| 路径 | /project/quality | 路由路径 |

### 列表页面配置

#### 项目信息列表页
**默认显示列：**
| 列名 | 显示名称 | 宽度 | 排序 | 可搜索 |
|------|----------|------|------|--------|
| ProjectCode | 项目编号 | 120px | 是 | 是 |
| ProjectName | 项目名称 | 200px | 是 | 是 |
| ProjectType | 项目类型 | 100px | 是 | 是 |
| ProjectStatus | 项目状态 | 100px | 是 | 是 |
| ManagerName | 项目经理 | 120px | 是 | 是 |
| StartDate | 开工日期 | 120px | 是 | 是 |
| EndDate | 竣工日期 | 120px | 是 | 是 |
| ContractAmount | 合同金额 | 150px | 是 | 否 |

**列表操作按钮：**
- 新增：创建新项目
- 编辑：修改项目信息
- 删除：删除项目（软删除）
- 导出：导出项目列表
- 导入：导入项目数据
- 查看：查看项目详情

#### 施工计划列表页
**默认显示列：**
| 列名 | 显示名称 | 宽度 | 排序 | 可搜索 |
|------|----------|------|------|--------|
| PlanCode | 计划编号 | 120px | 是 | 是 |
| PlanName | 计划名称 | 200px | 是 | 是 |
| PlanType | 计划类型 | 100px | 是 | 是 |
| StartDate | 开始日期 | 120px | 是 | 是 |
| EndDate | 结束日期 | 120px | 是 | 是 |
| CompletionRate | 完成率 | 100px | 是 | 否 |
| Status | 计划状态 | 100px | 是 | 是 |
| ResponsiblePerson | 负责人 | 120px | 是 | 是 |

#### 质量检查列表页
**默认显示列：**
| 列名 | 显示名称 | 宽度 | 排序 | 可搜索 |
|------|----------|------|------|--------|
| CheckCode | 检查编号 | 120px | 是 | 是 |
| CheckItem | 检查项目 | 200px | 是 | 是 |
| CheckType | 检查类型 | 100px | 是 | 是 |
| CheckDate | 检查日期 | 120px | 是 | 是 |
| CheckResult | 检查结果 | 100px | 是 | 是 |
| Checker | 检查人员 | 120px | 是 | 是 |
| QualityLevel | 质量等级 | 100px | 是 | 是 |
| RectificationStatus | 整改状态 | 120px | 是 | 是 |

### 表单页面配置

#### 表单布局
- **布局方式**：网格布局
- **列数**：2列
- **字段分组**：基础信息、时间信息、人员信息、其他信息

#### 项目信息表单
**基础信息组：**
- ProjectCode（项目编号）
- ProjectName（项目名称）
- ProjectType（项目类型）下拉选择
- ProjectStatus（项目状态）下拉选择

**时间信息组：**
- StartDate（开工日期）日期选择器
- EndDate（竣工日期）日期选择器

**单位信息组：**
- ConstructionUnit（建设单位）
- DesignUnit（设计单位）
- SupervisionUnit（监理单位）
- ConstructionUnit（施工单位）

**人员信息组：**
- ManagerName（项目经理）
- ManagerPhone（项目经理电话）
- TechnicalDirector（技术负责人）
- SafetyDirector（安全负责人）

**金额信息组：**
- ContractAmount（合同金额）数值输入

**位置信息组：**
- ProjectAddress（项目地址）
- Latitude（纬度）地图选择
- Longitude（经度）地图选择

**等级信息组：**
- SafetyLevel（安全等级）下拉选择
- QualityLevel（质量等级）下拉选择
- EnvironmentalLevel（环保等级）下拉选择

**描述信息组：**
- Description（项目描述）富文本编辑器
- Remark（备注信息）文本域

### 操作步骤

#### 配置菜单结构
1. 在菜单树中，选择"系统管理"作为父级菜单
2. 点击"添加子菜单"按钮
3. 输入菜单ID：menu-project-management
4. 输入菜单标签：项目管理
5. 选择图标：project
6. 设置排序：100
7. 输入路径：/project
8. 点击"保存"按钮

#### 添加子菜单
1. 在项目管理菜单下，点击"添加子菜单"
2. 输入菜单ID：menu-project-info
3. 输入菜单标签：项目信息
4. 选择图标：info
5. 设置排序：10
6. 输入路径：/project/list
7. 重复上述步骤，添加施工计划和质量检查菜单

#### 配置列表页面
1. 在项目信息列表配置中，勾选要显示的列
2. 设置每列的宽度和排序
3. 配置搜索字段
4. 设置默认分页大小：20条
5. 配置操作按钮权限

#### 配置表单页面
1. 在表单配置中，选择"网格布局"
2. 设置列数为：2
3. 创建字段分组：基础信息、时间信息、单位信息、人员信息、金额信息、位置信息、等级信息、描述信息
4. 将字段拖拽到相应的分组中
5. 配置字段验证规则

### 验证点
- 菜单层级：正确的父子关系
- 菜单排序：按预期顺序显示
- 路由配置：路径正确且唯一
- 权限集成：菜单项权限正确绑定
- 列表配置：显示列与实体属性匹配
- 表单布局：字段分组合理，用户体验良好

## 第五步：预览与生成

### 代码生成预览

#### 生成文件列表
**后端文件：**
```
src/
├── SmartConstruction.Domain/
│   ├── Projects/
│   │   ├── Project.cs                    # 项目实体
│   │   ├── ProjectManager.cs             # 项目管理器
│   │   └── IProjectRepository.cs         # 项目仓储接口
│   ├── Plans/
│   │   ├── ConstructionPlan.cs            # 施工计划实体
│   │   └── IConstructionPlanRepository.cs
│   └── Quality/
│       ├── QualityCheck.cs               # 质量检查实体
│       └── IQualityCheckRepository.cs
├── SmartConstruction.Application/
│   ├── Projects/
│   │   ├── ProjectAppService.cs          # 项目应用服务
│   │   ├── ProjectDto.cs                 # 项目DTO
│   │   └── IProjectAppService.cs
│   ├── Plans/
│   │   ├── ConstructionPlanAppService.cs
│   │   └── ConstructionPlanDto.cs
│   └── Quality/
│       ├── QualityCheckAppService.cs
│       └── QualityCheckDto.cs
└── SmartConstruction.HttpApi/
    └── Controllers/
        ├── ProjectController.cs          # 项目控制器
        ├── ConstructionPlanController.cs
        └── QualityCheckController.cs
```

**前端文件：**
```
src/
├── views/
│   └── project-management/
│       ├── project/
│       │   ├── list.vue                  # 项目列表页面
│       │   ├── form.vue                  # 项目表单页面
│       │   └── detail.vue                # 项目详情页面
│       ├── construction-plan/
│       │   ├── list.vue
│       │   ├── form.vue
│       │   └── detail.vue
│       └── quality-check/
│           ├── list.vue
│           ├── form.vue
│           └── detail.vue
├── api/
│   └── project-management/
│       ├── project.ts                    # 项目API
│       ├── construction-plan.ts
│       └── quality-check.ts
├── store/
│   └── modules/
│       └── project-management.ts           # Vuex模块
└── router/
    └── modules/
        └── project-management.ts           # 路由配置
```

**数据库文件：**
```
src/
└── SmartConstruction.EntityFrameworkCore/
    ├── Migrations/
    │   └── 20240101_AddProjectManagement.cs
    └── EntityFrameworkCore/
        └── SmartConstructionDbContext.cs   # 数据库上下文更新
```

#### 生成统计信息
- **总文件数**：45个文件
- **总代码行数**：约3,200行
- **生成时间**：约15-30秒
- **后端文件**：25个（约2,100行）
- **前端文件**：15个（约800行）
- **数据库文件**：5个（约300行）

### 代码质量检查

#### 结构验证
1. **实体验证**：
   - 所有实体属性正确映射
   - 关系配置正确
   - 验证规则完整

2. **服务验证**：
   - 应用服务接口完整
   - DTO映射正确
   - 权限检查集成

3. **控制器验证**：
   - RESTful API规范
   - 权限属性配置
   - 异常处理机制

4. **前端验证**：
   - 页面组件结构
   - API调用正确
   - 权限控制集成

#### 编译检查
1. **后端编译**：
   - C#语法正确性
   - 依赖注入配置
   - 数据库迁移脚本

2. **前端编译**：
   - TypeScript类型检查
   - Vue组件语法
   - 路由配置正确

3. **数据库脚本**：
   - SQL语法正确性
   - 表结构完整性
   - 索引和约束

### 操作步骤

#### 代码预览
1. 点击"预览代码"按钮
2. 查看生成的文件列表
3. 逐个检查关键文件内容
4. 验证代码结构和语法

#### 质量检查
1. 点击"结构化校验"按钮
2. 查看校验结果报告
3. 处理警告和错误信息
4. 重新校验直到通过

#### 试运行生成
1. 点击"试运行"按钮
2. 查看生成的文件列表
3. 检查文件路径和内容
4. 验证生成统计信息

#### 正式生成
1. 确认所有配置正确
2. 点击"生成代码"按钮
3. 等待生成完成
4. 查看生成报告

#### 后续操作
1. **后端操作**：
   - 运行数据库迁移命令
   - 编译后端项目
   - 启动后端服务

2. **前端操作**：
   - 安装新增依赖包
   - 编译前端项目
   - 部署前端应用

3. **测试操作**：
   - 运行单元测试
   - 执行集成测试
   - 进行功能测试

### 验证点

#### 生成验证
- **文件完整性**：所有预期文件生成
- **代码质量**：符合编码规范
- **编译成功**：无编译错误
- **功能正确**：业务逻辑正确

#### 部署验证
- **数据库迁移**：表结构正确创建
- **服务启动**：应用服务正常启动
- **API测试**：接口功能正常
- **前端访问**：页面正常显示

#### 功能验证
- **CRUD操作**：增删改查功能正常
- **权限控制**：权限验证正确
- **数据验证**：输入验证有效
- **异常处理**：错误处理完善

## 测试数据准备

### 初始化数据

#### 项目测试数据
```sql
-- 插入项目测试数据
INSERT INTO Projects (
    Id, ProjectCode, ProjectName, ProjectType, ConstructionUnit, DesignUnit, 
    SupervisionUnit, ConstructionUnit, ContractAmount, StartDate, EndDate, 
    ProjectAddress, ProjectStatus, SafetyLevel, QualityLevel, EnvironmentalLevel, 
    ManagerName, ManagerPhone, TechnicalDirector, SafetyDirector, 
    Latitude, Longitude, Description, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), 'GC2024001', '智慧工地示范工程一期', '住宅', 
    '中建三局集团有限公司', '中建设计研究院', '中建监理有限公司', '中建三局施工公司',
    15000.00, '2024-03-01', '2025-12-31', '北京市朝阳区智慧园区1号', '在建',
    '一级', '优良', '绿色', '张三', '13800138000', '李四', '王五',
    39.9042, 116.4074, '本项目为智慧工地示范工程，采用先进的物联网技术和BIM技术',
    '测试项目', GETUTCDATE(), NULL, NULL
);

INSERT INTO Projects (
    Id, ProjectCode, ProjectName, ProjectType, ConstructionUnit, DesignUnit, 
    SupervisionUnit, ConstructionUnit, ContractAmount, StartDate, EndDate, 
    ProjectAddress, ProjectStatus, SafetyLevel, QualityLevel, EnvironmentalLevel, 
    ManagerName, ManagerPhone, TechnicalDirector, SafetyDirector, 
    Latitude, Longitude, Description, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), 'GC2024002', '智慧工地示范工程二期', '商业', 
    '中建五局集团有限公司', '中建设计研究院', '中建监理有限公司', '中建五局施工公司',
    25000.00, '2024-06-01', '2026-06-30', '上海市浦东新区智慧园区2号', '筹备',
    '一级', '优良', '绿色', '赵六', '13900139000', '钱七', '孙八',
    31.2304, 121.4737, '本项目为智慧工地示范工程二期，商业综合体项目',
    '二期项目', GETUTCDATE(), NULL, NULL
);

INSERT INTO Projects (
    Id, ProjectCode, ProjectName, ProjectType, ConstructionUnit, DesignUnit, 
    SupervisionUnit, ConstructionUnit, ContractAmount, StartDate, EndDate, 
    ProjectAddress, ProjectStatus, SafetyLevel, QualityLevel, EnvironmentalLevel, 
    ManagerName, ManagerPhone, TechnicalDirector, SafetyDirector, 
    Latitude, Longitude, Description, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), 'GC2024003', '智慧工地示范工程三期', '工业', 
    '中建八局集团有限公司', '中建设计研究院', '中建监理有限公司', '中建八局施工公司',
    35000.00, '2024-09-01', '2027-03-31', '广州市天河区智慧园区3号', '筹备',
    '特级', '优质', '绿色', '周九', '13700137000', '吴十', '郑十一',
    23.1291, 113.2644, '本项目为智慧工地示范工程三期，工业厂房项目',
    '三期项目', GETUTCDATE(), NULL, NULL
);
```

#### 施工计划测试数据
```sql
-- 获取项目ID用于关联
DECLARE @ProjectId1 UNIQUEIDENTIFIER = (SELECT TOP 1 Id FROM Projects WHERE ProjectCode = 'GC2024001');
DECLARE @ProjectId2 UNIQUEIDENTIFIER = (SELECT TOP 1 Id FROM Projects WHERE ProjectCode = 'GC2024002');

-- 插入施工计划测试数据
INSERT INTO ConstructionPlans (
    Id, ProjectId, PlanCode, PlanName, PlanType, StartDate, EndDate, Duration, 
    Weight, PredecessorTask, SuccessorTask, CriticalPath, Milestone, CompletionRate, 
    Status, ResponsiblePerson, Description, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, 'JH2024001', '主体结构施工计划', '总计划',
    '2024-03-01', '2024-08-31', 180, 0.40, NULL, 'JH2024002', 1, 0, 0.0,
    '进行中', '赵六', '主体结构施工总计划，包含土建、钢筋、混凝土等工序',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO ConstructionPlans (
    Id, ProjectId, PlanCode, PlanName, PlanType, StartDate, EndDate, Duration, 
    Weight, PredecessorTask, SuccessorTask, CriticalPath, Milestone, CompletionRate, 
    Status, ResponsiblePerson, Description, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, 'JH2024002', '装饰装修施工计划', '总计划',
    '2024-09-01', '2025-02-28', 180, 0.30, 'JH2024001', 'JH2024003', 1, 0, 0.0,
    '待开始', '钱七', '装饰装修施工计划，包含内外装修、门窗安装等工序',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO ConstructionPlans (
    Id, ProjectId, PlanCode, PlanName, PlanType, StartDate, EndDate, Duration, 
    Weight, PredecessorTask, SuccessorTask, CriticalPath, Milestone, CompletionRate, 
    Status, ResponsiblePerson, Description, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, 'JH2024003', '机电安装施工计划', '总计划',
    '2025-03-01', '2025-08-31', 180, 0.20, 'JH2024002', 'JH2024004', 1, 0, 0.0,
    '待开始', '孙八', '机电安装施工计划，包含水电、暖通、消防等安装',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO ConstructionPlans (
    Id, ProjectId, PlanCode, PlanName, PlanType, StartDate, EndDate, Duration, 
    Weight, PredecessorTask, SuccessorTask, CriticalPath, Milestone, CompletionRate, 
    Status, ResponsiblePerson, Description, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, 'JH2024004', '竣工验收计划', '里程碑',
    '2025-09-01', '2025-12-31', 120, 0.10, 'JH2024003', NULL, 1, 1, 0.0,
    '待开始', '周九', '竣工验收计划，包含各项验收、备案等手续',
    GETUTCDATE(), NULL, NULL
);
```

#### 质量检查测试数据
```sql
-- 获取项目和计划ID用于关联
DECLARE @ProjectId1 UNIQUEIDENTIFIER = (SELECT TOP 1 Id FROM Projects WHERE ProjectCode = 'GC2024001');
DECLARE @PlanId1 UNIQUEIDENTIFIER = (SELECT TOP 1 Id FROM ConstructionPlans WHERE PlanCode = 'JH2024001');
DECLARE @PlanId2 UNIQUEIDENTIFIER = (SELECT TOP 1 Id FROM ConstructionPlans WHERE PlanCode = 'JH2024002');

-- 插入质量检查测试数据
INSERT INTO QualityChecks (
    Id, ProjectId, PlanId, CheckCode, CheckItem, CheckType, CheckDate, CheckResult, 
    CheckStandard, CheckMethod, Checker, QualityLevel, IssueDescription, RectificationMeasures, 
    RectificationDeadline, RectificationStatus, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, @PlanId1, 'JC2024001', '混凝土强度检测', '材料',
    '2024-03-15', '合格', 'GB/T 50081-2019', '回弹法检测', '孙七', '优良',
    NULL, NULL, NULL, NULL, '主体结构混凝土强度检测',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO QualityChecks (
    Id, ProjectId, PlanId, CheckCode, CheckItem, CheckType, CheckDate, CheckResult, 
    CheckStandard, CheckMethod, Checker, QualityLevel, IssueDescription, RectificationMeasures, 
    RectificationDeadline, RectificationStatus, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, @PlanId1, 'JC2024002', '钢筋规格检查', '材料',
    '2024-03-20', '合格', 'GB/T 1499.2-2018', '现场抽样检测', '李四', '优良',
    NULL, NULL, NULL, NULL, '主体结构钢筋规格和质量检查',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO QualityChecks (
    Id, ProjectId, PlanId, CheckCode, CheckItem, CheckType, CheckDate, CheckResult, 
    CheckStandard, CheckMethod, Checker, QualityLevel, IssueDescription, RectificationMeasures, 
    RectificationDeadline, RectificationStatus, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, @PlanId1, 'JC2024003', '模板安装检查', '工艺',
    '2024-03-25', '不合格', 'GB 50204-2015', '现场实测实量', '王五', '合格',
    '模板拼缝不均匀，部分模板变形', '更换变形模板，重新调整拼缝', '2024-03-28', '已整改',
    '主体结构模板安装质量检查',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO QualityChecks (
    Id, ProjectId, PlanId, CheckCode, CheckItem, CheckType, CheckDate, CheckResult, 
    CheckStandard, CheckMethod, Checker, QualityLevel, IssueDescription, RectificationMeasures, 
    RectificationDeadline, RectificationStatus, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, @PlanId2, 'JC2024004', '砌体垂直度检查', '工艺',
    '2024-04-01', '合格', 'GB 50203-2011', '靠尺检测', '赵六', '优良',
    NULL, NULL, NULL, NULL, '砌体工程垂直度和平整度检查',
    GETUTCDATE(), NULL, NULL
);

INSERT INTO QualityChecks (
    Id, ProjectId, PlanId, CheckCode, CheckItem, CheckType, CheckDate, CheckResult, 
    CheckStandard, CheckMethod, Checker, QualityLevel, IssueDescription, RectificationMeasures, 
    RectificationDeadline, RectificationStatus, Remark, CreationTime, CreatorId, TenantId
) VALUES (
    NEWID(), @ProjectId1, NULL, 'JC2024005', '安全文明施工检查', '综合',
    '2024-04-05', '合格', 'JGJ 59-2011', '现场检查评分', '钱七', '优良',
    NULL, NULL, NULL, NULL, '施工现场安全文明施工综合检查',
    GETUTCDATE(), NULL, NULL
);
```

### 测试用例

#### 功能测试用例
1. **项目创建测试**：
   - 输入完整项目信息
   - 验证必填字段
   - 检查数据保存

2. **施工计划测试**：
   - 关联项目创建计划
   - 验证时间逻辑
   - 检查进度更新

3. **质量检查测试**：
   - 创建检查记录
   - 上传检查文件
   - 跟踪整改过程

4. **权限测试**：
   - 不同角色登录
   - 验证功能权限
   - 测试数据隔离

#### 性能测试用例
1. **并发测试**：
   - 多用户同时操作
   - 大数据量处理
   - 响应时间监控

2. **压力测试**：
   - 批量数据导入
   - 复杂查询执行
   - 系统稳定性

#### 安全测试用例
1. **输入验证**：
   - SQL注入测试
   - XSS攻击测试
   - 文件上传安全

2. **权限安全**：
   - 越权访问测试
   - 数据泄露检查
   - 会话安全管理

## 常见问题处理

### 生成失败处理

#### 常见错误类型
1. **实体验证错误**：
   - 属性名称重复
   - 关系配置错误
   - 数据类型不匹配

2. **权限配置错误**：
   - 权限命名冲突
   - 角色权限缺失
   - 权限路径错误

3. **代码生成错误**：
   - 模板解析失败
   - 文件路径冲突
   - 编译错误

#### 解决方案
1. **检查输入数据**：
   - 验证所有必填字段
   - 检查命名规范
   - 确认关系完整性

2. **查看错误日志**：
   - 分析错误信息
   - 定位问题源头
   - 逐步修复问题

3. **重新生成**：
   - 修正配置错误
   - 清理生成缓存
   - 重新执行生成

### 部署问题处理

#### 数据库问题
1. **迁移失败**：
   - 检查数据库连接
   - 验证表结构
   - 处理数据冲突

2. **权限问题**：
   - 检查数据库权限
   - 验证用户角色
   - 配置访问权限

#### 服务启动问题
1. **依赖注入**：
   - 检查服务注册
   - 验证接口实现
   - 处理循环依赖

2. **配置错误**：
   - 检查配置文件
   - 验证连接字符串
   - 确认环境变量

### 功能异常处理

#### 页面显示问题
1. **空白页面**：
   - 检查路由配置
   - 验证组件加载
   - 查看控制台错误

2. **数据不显示**：
   - 检查API调用
   - 验证数据格式
   - 确认权限设置

#### 操作失败问题
1. **保存失败**：
   - 检查验证规则
   - 验证数据完整性
   - 查看后端日志

2. **权限不足**：
   - 检查用户权限
   - 验证角色配置
   - 确认权限缓存

## 总结

本测试输入物料和操作说明基于SmartAbp低代码引擎的五步式模块向导设计，涵盖了智慧工地项目管理模块的完整开发流程。通过详细的参数配置、操作步骤和验证点，可以全面测试低代码引擎的前后端代码生成能力和企业级UI界面生成功能。

测试过程中需要重点关注：
1. **类型安全**：严格类型系统的验证和应用
2. **代码质量**：生成代码的结构和质量
3. **功能完整性**：业务功能的完整实现
4. **性能表现**：生成效率和运行性能
5. **安全机制**：权限控制和数据验证
6. **用户体验**：界面友好性和操作便捷性

通过系统性的测试，可以验证低代码引擎是否满足企业级应用开发的需求，并为后续优化提供具体的改进方向。