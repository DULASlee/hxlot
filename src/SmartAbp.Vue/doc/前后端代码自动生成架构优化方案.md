# å‰åç«¯ä»£ç è‡ªåŠ¨ç”Ÿæˆæ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ

## ğŸ“‹ ç°æœ‰æ¶æ„åˆ†æ

### å‰ç«¯ç°çŠ¶åˆ†æ
```typescript
// å½“å‰å‰ç«¯æ¶æ„é—®é¢˜ï¼š
âŒ APIè°ƒç”¨åˆ†æ•£ï¼Œç¼ºä¹ç»Ÿä¸€è§„èŒƒ
âŒ ç±»å‹å®šä¹‰é‡å¤ï¼Œç»´æŠ¤å›°éš¾  
âŒ æ‰‹å·¥ç¼–å†™APIå®¢æˆ·ç«¯ä»£ç 
âŒ é”™è¯¯å¤„ç†ä¸ç»Ÿä¸€
âŒ ç¼ºä¹APIç‰ˆæœ¬ç®¡ç†
âŒ æ–‡æ¡£ä¸ä»£ç ä¸åŒæ­¥
```

### åç«¯ç°çŠ¶åˆ†æ
```csharp
// å½“å‰åç«¯æ¶æ„é—®é¢˜ï¼š
âŒ APIæ–‡æ¡£éœ€è¦æ‰‹å·¥ç»´æŠ¤
âŒ å‰ç«¯ç±»å‹å®šä¹‰ä¸åç«¯æ¨¡å‹ä¸åŒæ­¥
âŒ ç¼ºä¹ç»Ÿä¸€çš„å“åº”æ ¼å¼
âŒ ç‰ˆæœ¬ç®¡ç†æœºåˆ¶ä¸å®Œå–„
âŒ APIå˜æ›´å½±å“å‰ç«¯å¼€å‘æ•ˆç‡
```

## ğŸš€ ä»£ç è‡ªåŠ¨ç”Ÿæˆæ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ

### æ¶æ„å‡çº§æ ¸å¿ƒç›®æ ‡
1. **å¥‘çº¦ä¼˜å…ˆè®¾è®¡** - APIå¥‘çº¦é©±åŠ¨å¼€å‘
2. **ç±»å‹å®‰å…¨ä¿è¯** - å‰åç«¯ç±»å‹å®Œå…¨åŒæ­¥
3. **è‡ªåŠ¨ä»£ç ç”Ÿæˆ** - å‡å°‘90%é‡å¤ä»£ç ç¼–å†™
4. **æ–‡æ¡£è‡ªåŠ¨æ›´æ–°** - APIæ–‡æ¡£ä¸ä»£ç 100%åŒæ­¥
5. **ç‰ˆæœ¬æ— ç¼ç®¡ç†** - æ”¯æŒå¤šç‰ˆæœ¬APIå¹¶å­˜

## ğŸ“ æ¶æ„è®¾è®¡è“å›¾

### æ•´ä½“æ¶æ„æµç¨‹
```mermaid
graph TD
    A[APIå¥‘çº¦å®šä¹‰<br/>OpenAPI 3.0] --> B[åç«¯ä»£ç ç”Ÿæˆ<br/>Controllers/DTOs]
    A --> C[å‰ç«¯ä»£ç ç”Ÿæˆ<br/>API Client/Types]
    A --> D[æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ<br/>Swagger UI]
    
    B --> E[åç«¯éªŒè¯<br/>Contract Testing]
    C --> F[å‰ç«¯éªŒè¯<br/>Type Checking]
    
    E --> G[CI/CDé›†æˆ<br/>è‡ªåŠ¨éƒ¨ç½²]
    F --> G
    
    G --> H[ç‰ˆæœ¬ç®¡ç†<br/>API Versioning]
    H --> I[ç›‘æ§å‘Šè­¦<br/>Breaking Changes]
```

## ğŸ”§ æŠ€æœ¯å®æ–½æ–¹æ¡ˆ

### 1. APIå¥‘çº¦ä¼˜å…ˆè®¾è®¡

#### 1.1 OpenAPI 3.0 è§„èŒƒå®šä¹‰
```yaml
# api-contracts/smartabp-api.yaml
openapi: 3.0.3
info:
  title: SmartAbp API
  version: 1.0.0
  description: æ™ºèƒ½å·¥åœ°ç®¡ç†ç³»ç»ŸAPI
  contact:
    name: APIæ”¯æŒ
    email: support@smartabp.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.smartabp.com/v1
    description: ç”Ÿäº§ç¯å¢ƒ
  - url: https://api-staging.smartabp.com/v1
    description: æµ‹è¯•ç¯å¢ƒ
  - url: http://localhost:5000/v1
    description: å¼€å‘ç¯å¢ƒ

# ç»Ÿä¸€å“åº”æ ¼å¼
components:
  schemas:
    ApiResponse:
      type: object
      required:
        - success
        - timestamp
        - traceId
      properties:
        success:
          type: boolean
          description: è¯·æ±‚æ˜¯å¦æˆåŠŸ
        data:
          description: å“åº”æ•°æ®
        message:
          type: string
          description: å“åº”æ¶ˆæ¯
        code:
          type: string
          description: ä¸šåŠ¡é”™è¯¯ç 
        timestamp:
          type: string
          format: date-time
          description: å“åº”æ—¶é—´æˆ³
        traceId:
          type: string
          description: é“¾è·¯è¿½è¸ªID
        pagination:
          $ref: '#/components/schemas/PaginationInfo'
        
    PaginationInfo:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          description: å½“å‰é¡µç 
        pageSize:
          type: integer
          minimum: 1
          maximum: 100
          description: æ¯é¡µå¤§å°
        total:
          type: integer
          minimum: 0
          description: æ€»è®°å½•æ•°
        totalPages:
          type: integer
          minimum: 0
          description: æ€»é¡µæ•°
        hasNext:
          type: boolean
          description: æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
        hasPrevious:
          type: boolean
          description: æ˜¯å¦æœ‰ä¸Šä¸€é¡µ

    # ç”¨æˆ·ç›¸å…³æ¨¡å‹
    User:
      type: object
      required:
        - id
        - name
        - email
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          description: ç”¨æˆ·ID
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: ç”¨æˆ·å§“å
        email:
          type: string
          format: email
          description: é‚®ç®±åœ°å€
        phone:
          type: string
          pattern: '^1[3-9]\d{9}$'
          description: æ‰‹æœºå·ç 
        avatar:
          type: string
          format: uri
          description: å¤´åƒURL
        status:
          type: string
          enum: [active, inactive, pending]
          description: ç”¨æˆ·çŠ¶æ€
        roles:
          type: array
          items:
            type: string
          description: ç”¨æˆ·è§’è‰²
        lastLoginAt:
          type: string
          format: date-time
          description: æœ€åç™»å½•æ—¶é—´
        createdAt:
          type: string
          format: date-time
          description: åˆ›å»ºæ—¶é—´
        updatedAt:
          type: string
          format: date-time
          description: æ›´æ–°æ—¶é—´
        metadata:
          type: object
          additionalProperties: true
          description: æ‰©å±•ä¿¡æ¯

    CreateUserRequest:
      type: object
      required:
        - name
        - email
        - password
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: ç”¨æˆ·å§“å
        email:
          type: string
          format: email
          description: é‚®ç®±åœ°å€
        phone:
          type: string
          pattern: '^1[3-9]\d{9}$'
          description: æ‰‹æœºå·ç 
        password:
          type: string
          minLength: 8
          maxLength: 50
          description: å¯†ç 
        roles:
          type: array
          items:
            type: string
          description: ç”¨æˆ·è§’è‰²
        metadata:
          type: object
          additionalProperties: true
          description: æ‰©å±•ä¿¡æ¯

    UpdateUserRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: ç”¨æˆ·å§“å
        phone:
          type: string
          pattern: '^1[3-9]\d{9}$'
          description: æ‰‹æœºå·ç 
        avatar:
          type: string
          format: uri
          description: å¤´åƒURL
        status:
          type: string
          enum: [active, inactive, pending]
          description: ç”¨æˆ·çŠ¶æ€
        roles:
          type: array
          items:
            type: string
          description: ç”¨æˆ·è§’è‰²
        metadata:
          type: object
          additionalProperties: true
          description: æ‰©å±•ä¿¡æ¯

# APIè·¯å¾„å®šä¹‰
paths:
  /users:
    get:
      summary: è·å–ç”¨æˆ·åˆ—è¡¨
      description: åˆ†é¡µè·å–ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒç­›é€‰å’Œæ’åº
      operationId: getUsers
      tags: [Users]
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: é¡µç 
        - name: pageSize
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: æ¯é¡µå¤§å°
        - name: search
          in: query
          schema:
            type: string
          description: æœç´¢å…³é”®è¯
        - name: status
          in: query
          schema:
            type: string
            enum: [active, inactive, pending]
          description: ç”¨æˆ·çŠ¶æ€ç­›é€‰
        - name: sortBy
          in: query
          schema:
            type: string
            enum: [name, email, createdAt, updatedAt]
            default: createdAt
          description: æ’åºå­—æ®µ
        - name: sortOrder
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          description: æ’åºæ–¹å‘
      responses:
        200:
          description: æˆåŠŸè·å–ç”¨æˆ·åˆ—è¡¨
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/User'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        500:
          $ref: '#/components/responses/InternalError'

    post:
      summary: åˆ›å»ºæ–°ç”¨æˆ·
      description: åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·è´¦æˆ·
      operationId: createUser
      tags: [Users]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
      responses:
        201:
          description: ç”¨æˆ·åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        409:
          $ref: '#/components/responses/Conflict'
        500:
          $ref: '#/components/responses/InternalError'

  /users/{userId}:
    get:
      summary: è·å–ç”¨æˆ·è¯¦æƒ…
      description: æ ¹æ®IDè·å–ç‰¹å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯
      operationId: getUserById
      tags: [Users]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ç”¨æˆ·ID
      responses:
        200:
          description: æˆåŠŸè·å–ç”¨æˆ·ä¿¡æ¯
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalError'

    put:
      summary: æ›´æ–°ç”¨æˆ·ä¿¡æ¯
      description: æ›´æ–°æŒ‡å®šç”¨æˆ·çš„ä¿¡æ¯
      operationId: updateUser
      tags: [Users]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ç”¨æˆ·ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      responses:
        200:
          description: ç”¨æˆ·æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        409:
          $ref: '#/components/responses/Conflict'
        500:
          $ref: '#/components/responses/InternalError'

    delete:
      summary: åˆ é™¤ç”¨æˆ·
      description: è½¯åˆ é™¤æŒ‡å®šçš„ç”¨æˆ·
      operationId: deleteUser
      tags: [Users]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ç”¨æˆ·ID
      responses:
        204:
          description: ç”¨æˆ·åˆ é™¤æˆåŠŸ
        400:
          $ref: '#/components/responses/BadRequest'
        401:
          $ref: '#/components/responses/Unauthorized'
        403:
          $ref: '#/components/responses/Forbidden'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalError'

# é€šç”¨é”™è¯¯å“åº”
components:
  responses:
    BadRequest:
      description: è¯·æ±‚å‚æ•°é”™è¯¯
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  success:
                    example: false
                  code:
                    example: "BAD_REQUEST"
                  message:
                    example: "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥"
                  data:
                    type: object
                    properties:
                      errors:
                        type: array
                        items:
                          type: object
                          properties:
                            field:
                              type: string
                            message:
                              type: string
                            code:
                              type: string
    
    Unauthorized:
      description: æœªæˆæƒè®¿é—®
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  success:
                    example: false
                  code:
                    example: "UNAUTHORIZED"
                  message:
                    example: "è¯·å…ˆç™»å½•åå†è®¿é—®"

    Forbidden:
      description: æƒé™ä¸è¶³
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  success:
                    example: false
                  code:
                    example: "FORBIDDEN"
                  message:
                    example: "æ²¡æœ‰æƒé™æ‰§è¡Œæ­¤æ“ä½œ"

    NotFound:
      description: èµ„æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  success:
                    example: false
                  code:
                    example: "NOT_FOUND"
                  message:
                    example: "è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨"

    Conflict:
      description: èµ„æºå†²çª
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  success:
                    example: false
                  code:
                    example: "CONFLICT"
                  message:
                    example: "èµ„æºå·²å­˜åœ¨æˆ–çŠ¶æ€å†²çª"

    InternalError:
      description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  success:
                    example: false
                  code:
                    example: "INTERNAL_ERROR"
                  message:
                    example: "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"

  # å®‰å…¨æ–¹æ¡ˆ
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Tokenè®¤è¯

# å…¨å±€å®‰å…¨è¦æ±‚
security:
  - BearerAuth: []
```

### 2. åç«¯ä»£ç è‡ªåŠ¨ç”Ÿæˆ

#### 2.1 ä»£ç ç”Ÿæˆé…ç½®
```json
// codegen/backend-config.json
{
  "generator": "aspnetcore",
  "version": "3.0.0",
  "config": {
    "packageName": "SmartAbp.Api",
    "packageVersion": "1.0.0",
    "packageCompany": "SmartAbp Inc",
    "packageAuthors": "SmartAbp Team",
    "packageDescription": "SmartAbp API Server",
    "clientPackage": "SmartAbp.Client",
    "packageTitle": "SmartAbp API",
    "targetFramework": "net8.0",
    "sourceFolder": "src/main/csharp",
    "packageGuid": "{12345678-1234-5678-9ABC-123456789ABC}",
    "useCollection": "true",
    "returnICollection": "false",
    "optionalMethodArgument": "true",
    "generatePropertyChanged": "false",
    "nonPublicApi": "false",
    "hideGenerationTimestamp": "true",
    "packageContext": "SmartAbpContext",
    "clientGuid": "{12345678-1234-5678-9ABC-123456789ABD}",
    "generateModels": "true",
    "generateApis": "true",
    "generateSupportingFiles": "true",
    "modelPackage": "SmartAbp.Models",
    "apiPackage": "SmartAbp.Controllers",
    "operationModifier": "public virtual",
    "operationIsAsync": "true",
    "operationResultTask": "true",
    "systemWeb": "false",
    "excludeTests": "false",
    "generateDocumentation": "true",
    "generateExamples": "true"
  },
  "additionalProperties": {
    "validationAttributes": "true",
    "generateSwaggerAnnotations": "true",
    "useModelPrefix": "false",
    "useEnumPrefix": "false",
    "enumNameSuffix": "Enum",
    "enumValueSuffix": "Value",
    "useOneOfDiscriminator": "true",
    "legacyDiscriminatorBehavior": "false",
    "allowUnicodeIdentifiers": "true",
    "prependFormOrBodyParameters": "false"
  }
}
```

#### 2.2 ç”Ÿæˆçš„åç«¯ä»£ç ç»“æ„
```csharp
// è‡ªåŠ¨ç”Ÿæˆçš„æ¨¡å‹ç±»
// src/SmartAbp.Api/Models/User.cs
namespace SmartAbp.Models
{
    /// <summary>
    /// ç”¨æˆ·æ¨¡å‹
    /// </summary>
    [System.CodeDom.Compiler.GeneratedCode("OpenAPITools", "1.0.0")]
    public partial class User : IEquatable<User>, IValidatableObject
    {
        /// <summary>
        /// ç”¨æˆ·ID
        /// </summary>
        [Required]
        [DataType(DataType.Text)]
        public Guid Id { get; set; }

        /// <summary>
        /// ç”¨æˆ·å§“å
        /// </summary>
        [Required]
        [StringLength(100, MinimumLength = 1)]
        public string Name { get; set; }

        /// <summary>
        /// é‚®ç®±åœ°å€
        /// </summary>
        [Required]
        [EmailAddress]
        public string Email { get; set; }

        /// <summary>
        /// æ‰‹æœºå·ç 
        /// </summary>
        [RegularExpression(@"^1[3-9]\d{9}$")]
        public string Phone { get; set; }

        /// <summary>
        /// å¤´åƒURL
        /// </summary>
        [Url]
        public string Avatar { get; set; }

        /// <summary>
        /// ç”¨æˆ·çŠ¶æ€
        /// </summary>
        [Required]
        public UserStatusEnum Status { get; set; }

        /// <summary>
        /// ç”¨æˆ·è§’è‰²
        /// </summary>
        public List<string> Roles { get; set; } = new List<string>();

        /// <summary>
        /// æœ€åç™»å½•æ—¶é—´
        /// </summary>
        public DateTime? LastLoginAt { get; set; }

        /// <summary>
        /// åˆ›å»ºæ—¶é—´
        /// </summary>
        [Required]
        public DateTime CreatedAt { get; set; }

        /// <summary>
        /// æ›´æ–°æ—¶é—´
        /// </summary>
        [Required]
        public DateTime UpdatedAt { get; set; }

        /// <summary>
        /// æ‰©å±•ä¿¡æ¯
        /// </summary>
        public Dictionary<string, object> Metadata { get; set; } = new Dictionary<string, object>();

        public bool Equals(User other)
        {
            if (other is null) return false;
            if (ReferenceEquals(this, other)) return true;
            return Id.Equals(other.Id);
        }

        public override bool Equals(object obj) => Equals(obj as User);
        public override int GetHashCode() => Id.GetHashCode();

        public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
        {
            // è‡ªå®šä¹‰éªŒè¯é€»è¾‘
            yield break;
        }
    }

    /// <summary>
    /// ç”¨æˆ·çŠ¶æ€æšä¸¾
    /// </summary>
    [JsonConverter(typeof(StringEnumConverter))]
    public enum UserStatusEnum
    {
        [EnumMember(Value = "active")]
        Active,
        
        [EnumMember(Value = "inactive")]
        Inactive,
        
        [EnumMember(Value = "pending")]
        Pending
    }
}

// è‡ªåŠ¨ç”Ÿæˆçš„ControlleråŸºç±»
// src/SmartAbp.Api/Controllers/UsersController.cs
namespace SmartAbp.Controllers
{
    /// <summary>
    /// ç”¨æˆ·ç®¡ç†API
    /// </summary>
    [ApiController]
    [Route("api/v1/users")]
    [Produces("application/json")]
    [System.CodeDom.Compiler.GeneratedCode("OpenAPITools", "1.0.0")]
    public abstract partial class UsersApiController : ControllerBase
    {
        /// <summary>
        /// è·å–ç”¨æˆ·åˆ—è¡¨
        /// </summary>
        /// <param name="page">é¡µç </param>
        /// <param name="pageSize">æ¯é¡µå¤§å°</param>
        /// <param name="search">æœç´¢å…³é”®è¯</param>
        /// <param name="status">ç”¨æˆ·çŠ¶æ€ç­›é€‰</param>
        /// <param name="sortBy">æ’åºå­—æ®µ</param>
        /// <param name="sortOrder">æ’åºæ–¹å‘</param>
        /// <param name="cancellationToken">å–æ¶ˆä»¤ç‰Œ</param>
        /// <returns>ç”¨æˆ·åˆ—è¡¨</returns>
        [HttpGet]
        [ProducesResponseType(typeof(ApiResponse<List<User>>), 200)]
        [ProducesResponseType(typeof(ApiResponse), 400)]
        [ProducesResponseType(typeof(ApiResponse), 401)]
        [ProducesResponseType(typeof(ApiResponse), 403)]
        [ProducesResponseType(typeof(ApiResponse), 500)]
        public abstract Task<IActionResult> GetUsersAsync(
            [FromQuery] int page = 1,
            [FromQuery] int pageSize = 20,
            [FromQuery] string search = null,
            [FromQuery] UserStatusEnum? status = null,
            [FromQuery] string sortBy = "createdAt",
            [FromQuery] string sortOrder = "desc",
            CancellationToken cancellationToken = default
        );

        /// <summary>
        /// åˆ›å»ºæ–°ç”¨æˆ·
        /// </summary>
        /// <param name="createUserRequest">åˆ›å»ºç”¨æˆ·è¯·æ±‚</param>
        /// <param name="cancellationToken">å–æ¶ˆä»¤ç‰Œ</param>
        /// <returns>åˆ›å»ºçš„ç”¨æˆ·ä¿¡æ¯</returns>
        [HttpPost]
        [ProducesResponseType(typeof(ApiResponse<User>), 201)]
        [ProducesResponseType(typeof(ApiResponse), 400)]
        [ProducesResponseType(typeof(ApiResponse), 401)]
        [ProducesResponseType(typeof(ApiResponse), 403)]
        [ProducesResponseType(typeof(ApiResponse), 409)]
        [ProducesResponseType(typeof(ApiResponse), 500)]
        public abstract Task<IActionResult> CreateUserAsync(
            [FromBody] CreateUserRequest createUserRequest,
            CancellationToken cancellationToken = default
        );

        /// <summary>
        /// è·å–ç”¨æˆ·è¯¦æƒ…
        /// </summary>
        /// <param name="userId">ç”¨æˆ·ID</param>
        /// <param name="cancellationToken">å–æ¶ˆä»¤ç‰Œ</param>
        /// <returns>ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</returns>
        [HttpGet("{userId}")]
        [ProducesResponseType(typeof(ApiResponse<User>), 200)]
        [ProducesResponseType(typeof(ApiResponse), 400)]
        [ProducesResponseType(typeof(ApiResponse), 401)]
        [ProducesResponseType(typeof(ApiResponse), 403)]
        [ProducesResponseType(typeof(ApiResponse), 404)]
        [ProducesResponseType(typeof(ApiResponse), 500)]
        public abstract Task<IActionResult> GetUserByIdAsync(
            [FromRoute] Guid userId,
            CancellationToken cancellationToken = default
        );

        /// <summary>
        /// æ›´æ–°ç”¨æˆ·ä¿¡æ¯
        /// </summary>
        /// <param name="userId">ç”¨æˆ·ID</param>
        /// <param name="updateUserRequest">æ›´æ–°ç”¨æˆ·è¯·æ±‚</param>
        /// <param name="cancellationToken">å–æ¶ˆä»¤ç‰Œ</param>
        /// <returns>æ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯</returns>
        [HttpPut("{userId}")]
        [ProducesResponseType(typeof(ApiResponse<User>), 200)]
        [ProducesResponseType(typeof(ApiResponse), 400)]
        [ProducesResponseType(typeof(ApiResponse), 401)]
        [ProducesResponseType(typeof(ApiResponse), 403)]
        [ProducesResponseType(typeof(ApiResponse), 404)]
        [ProducesResponseType(typeof(ApiResponse), 409)]
        [ProducesResponseType(typeof(ApiResponse), 500)]
        public abstract Task<IActionResult> UpdateUserAsync(
            [FromRoute] Guid userId,
            [FromBody] UpdateUserRequest updateUserRequest,
            CancellationToken cancellationToken = default
        );

        /// <summary>
        /// åˆ é™¤ç”¨æˆ·
        /// </summary>
        /// <param name="userId">ç”¨æˆ·ID</param>
        /// <param name="cancellationToken">å–æ¶ˆä»¤ç‰Œ</param>
        /// <returns>åˆ é™¤ç»“æœ</returns>
        [HttpDelete("{userId}")]
        [ProducesResponseType(204)]
        [ProducesResponseType(typeof(ApiResponse), 400)]
        [ProducesResponseType(typeof(ApiResponse), 401)]
        [ProducesResponseType(typeof(ApiResponse), 403)]
        [ProducesResponseType(typeof(ApiResponse), 404)]
        [ProducesResponseType(typeof(ApiResponse), 500)]
        public abstract Task<IActionResult> DeleteUserAsync(
            [FromRoute] Guid userId,
            CancellationToken cancellationToken = default
        );
    }
}

// å¼€å‘è€…å®ç°çš„å…·ä½“Controller
// src/SmartAbp.Api/Controllers/Impl/UsersController.Impl.cs
namespace SmartAbp.Controllers.Impl
{
    /// <summary>
    /// ç”¨æˆ·ç®¡ç†APIå®ç°
    /// </summary>
    public class UsersController : UsersApiController
    {
        private readonly IUserService _userService;
        private readonly ILogger<UsersController> _logger;

        public UsersController(IUserService userService, ILogger<UsersController> logger)
        {
            _userService = userService ?? throw new ArgumentNullException(nameof(userService));
            _logger = logger ?? throw new ArgumentNullException(nameof(logger));
        }

        public override async Task<IActionResult> GetUsersAsync(
            int page = 1,
            int pageSize = 20,
            string search = null,
            UserStatusEnum? status = null,
            string sortBy = "createdAt",
            string sortOrder = "desc",
            CancellationToken cancellationToken = default)
        {
            try
            {
                var users = await _userService.GetUsersAsync(
                    page, pageSize, search, status, sortBy, sortOrder, cancellationToken);

                return Ok(ApiResponse<List<User>>.Success(users.Data, users.Pagination));
            }
            catch (ValidationException ex)
            {
                return BadRequest(ApiResponse.Error("VALIDATION_ERROR", ex.Message, ex.ValidationErrors));
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Error getting users");
                return StatusCode(500, ApiResponse.Error("INTERNAL_ERROR", "è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥"));
            }
        }

        public override async Task<IActionResult> CreateUserAsync(
            CreateUserRequest createUserRequest,
            CancellationToken cancellationToken = default)
        {
            try
            {
                var user = await _userService.CreateUserAsync(createUserRequest, cancellationToken);
                return CreatedAtAction(nameof(GetUserByIdAsync), new { userId = user.Id }, 
                    ApiResponse<User>.Success(user));
            }
            catch (ValidationException ex)
            {
                return BadRequest(ApiResponse.Error("VALIDATION_ERROR", ex.Message, ex.ValidationErrors));
            }
            catch (ConflictException ex)
            {
                return Conflict(ApiResponse.Error("CONFLICT", ex.Message));
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Error creating user");
                return StatusCode(500, ApiResponse.Error("INTERNAL_ERROR", "åˆ›å»ºç”¨æˆ·å¤±è´¥"));
            }
        }

        // å…¶ä»–æ–¹æ³•å®ç°...
    }
}
```

### 3. å‰ç«¯ä»£ç è‡ªåŠ¨ç”Ÿæˆ

#### 3.1 å‰ç«¯ç”Ÿæˆé…ç½®
```json
// codegen/frontend-config.json
{
  "generator": "typescript-axios",
  "version": "3.0.0",
  "config": {
    "npmName": "@smartabp/api-client",
    "npmVersion": "1.0.0",
    "npmDescription": "SmartAbp API Client Library",
    "npmAuthor": "SmartAbp Team",
    "npmRepository": "https://github.com/smartabp/api-client",
    "supportsES6": "true",
    "withSeparateModelsAndApi": "true",
    "withoutPrefixEnums": "false",
    "modelPropertyNaming": "camelCase",
    "paramNaming": "camelCase",
    "enumNameSuffix": "",
    "enumPropertyNaming": "PascalCase",
    "stringEnums": "false",
    "snapshot": "false",
    "sortParamsByRequiredFlag": "true",
    "sortModelPropertiesByRequiredFlag": "true",
    "ensureUniqueParams": "true",
    "allowUnicodeIdentifiers": "true",
    "prependFormOrBodyParameters": "false",
    "useSingleRequestParameter": "false",
    "useObjectParameters": "true"
  },
  "additionalProperties": {
    "typescript": "true",
    "platform": "browser",
    "withInterfaces": "true",
    "withoutRuntimeChecks": "true",
    "useDateType": "true",
    "dateLibrary": "dayjs",
    "nullSafeAdditionalProps": "true",
    "usePromises": "true",
    "useInversify": "false",
    "useRxJS": "false",
    "useAxios": "true",
    "generateAliasAsModel": "true"
  }
}
```

#### 3.2 ç”Ÿæˆçš„å‰ç«¯ä»£ç ç»“æ„
```typescript
// è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å®šä¹‰
// src/api/generated/models/User.ts
/**
 * ç”¨æˆ·æ¨¡å‹
 */
export interface User {
    /**
     * ç”¨æˆ·ID
     */
    id: string;
    /**
     * ç”¨æˆ·å§“å
     */
    name: string;
    /**
     * é‚®ç®±åœ°å€
     */
    email: string;
    /**
     * æ‰‹æœºå·ç 
     */
    phone?: string;
    /**
     * å¤´åƒURL
     */
    avatar?: string;
    /**
     * ç”¨æˆ·çŠ¶æ€
     */
    status: UserStatusEnum;
    /**
     * ç”¨æˆ·è§’è‰²
     */
    roles?: string[];
    /**
     * æœ€åç™»å½•æ—¶é—´
     */
    lastLoginAt?: string;
    /**
     * åˆ›å»ºæ—¶é—´
     */
    createdAt: string;
    /**
     * æ›´æ–°æ—¶é—´
     */
    updatedAt: string;
    /**
     * æ‰©å±•ä¿¡æ¯
     */
    metadata?: { [key: string]: any };
}

/**
 * ç”¨æˆ·çŠ¶æ€æšä¸¾
 */
export enum UserStatusEnum {
    Active = 'active',
    Inactive = 'inactive',
    Pending = 'pending'
}

/**
 * åˆ›å»ºç”¨æˆ·è¯·æ±‚
 */
export interface CreateUserRequest {
    /**
     * ç”¨æˆ·å§“å
     */
    name: string;
    /**
     * é‚®ç®±åœ°å€
     */
    email: string;
    /**
     * æ‰‹æœºå·ç 
     */
    phone?: string;
    /**
     * å¯†ç 
     */
    password: string;
    /**
     * ç”¨æˆ·è§’è‰²
     */
    roles?: string[];
    /**
     * æ‰©å±•ä¿¡æ¯
     */
    metadata?: { [key: string]: any };
}

/**
 * æ›´æ–°ç”¨æˆ·è¯·æ±‚
 */
export interface UpdateUserRequest {
    /**
     * ç”¨æˆ·å§“å
     */
    name?: string;
    /**
     * æ‰‹æœºå·ç 
     */
    phone?: string;
    /**
     * å¤´åƒURL
     */
    avatar?: string;
    /**
     * ç”¨æˆ·çŠ¶æ€
     */
    status?: UserStatusEnum;
    /**
     * ç”¨æˆ·è§’è‰²
     */
    roles?: string[];
    /**
     * æ‰©å±•ä¿¡æ¯
     */
    metadata?: { [key: string]: any };
}

// è‡ªåŠ¨ç”Ÿæˆçš„APIå“åº”ç±»å‹
// src/api/generated/models/ApiResponse.ts
/**
 * APIç»Ÿä¸€å“åº”æ ¼å¼
 */
export interface ApiResponse<TData = any> {
    /**
     * è¯·æ±‚æ˜¯å¦æˆåŠŸ
     */
    success: boolean;
    /**
     * å“åº”æ•°æ®
     */
    data?: TData;
    /**
     * å“åº”æ¶ˆæ¯
     */
    message?: string;
    /**
     * ä¸šåŠ¡é”™è¯¯ç 
     */
    code?: string;
    /**
     * å“åº”æ—¶é—´æˆ³
     */
    timestamp: string;
    /**
     * é“¾è·¯è¿½è¸ªID
     */
    traceId: string;
    /**
     * åˆ†é¡µä¿¡æ¯
     */
    pagination?: PaginationInfo;
}

/**
 * åˆ†é¡µä¿¡æ¯
 */
export interface PaginationInfo {
    /**
     * å½“å‰é¡µç 
     */
    page?: number;
    /**
     * æ¯é¡µå¤§å°
     */
    pageSize?: number;
    /**
     * æ€»è®°å½•æ•°
     */
    total?: number;
    /**
     * æ€»é¡µæ•°
     */
    totalPages?: number;
    /**
     * æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
     */
    hasNext?: boolean;
    /**
     * æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
     */
    hasPrevious?: boolean;
}

// è‡ªåŠ¨ç”Ÿæˆçš„APIå®¢æˆ·ç«¯
// src/api/generated/apis/UsersApi.ts
import { AxiosPromise, AxiosInstance, AxiosRequestConfig } from 'axios';
import { Configuration } from '../configuration';
import { RequestArgs, BaseAPI, RequiredError } from '../base';
import { 
    ApiResponse, 
    User, 
    CreateUserRequest, 
    UpdateUserRequest, 
    UserStatusEnum 
} from '../models';

/**
 * UsersApi - axios parameter creator
 */
export const UsersApiAxiosParamCreator = function (configuration?: Configuration) {
    return {
        /**
         * åˆ†é¡µè·å–ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒç­›é€‰å’Œæ’åº
         * @summary è·å–ç”¨æˆ·åˆ—è¡¨
         * @param {number} [page] é¡µç 
         * @param {number} [pageSize] æ¯é¡µå¤§å°
         * @param {string} [search] æœç´¢å…³é”®è¯
         * @param {UserStatusEnum} [status] ç”¨æˆ·çŠ¶æ€ç­›é€‰
         * @param {string} [sortBy] æ’åºå­—æ®µ
         * @param {string} [sortOrder] æ’åºæ–¹å‘
         * @param {*} [options] Override http request option.
         * @throws {RequiredError}
         */
        getUsers: async (
            page?: number, 
            pageSize?: number, 
            search?: string, 
            status?: UserStatusEnum, 
            sortBy?: string, 
            sortOrder?: string, 
            options: AxiosRequestConfig = {}
        ): Promise<RequestArgs> => {
            const localVarPath = `/users`;
            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);
            let baseOptions;
            if (configuration) {
                baseOptions = configuration.baseOptions;
            }

            const localVarRequestOptions = { method: 'GET', ...baseOptions, ...options};
            const localVarHeaderParameter = {} as any;
            const localVarQueryParameter = {} as any;

            // authentication BearerAuth required
            await setOAuthToObject(localVarHeaderParameter, "BearerAuth", [], configuration)

            if (page !== undefined) {
                localVarQueryParameter['page'] = page;
            }

            if (pageSize !== undefined) {
                localVarQueryParameter['pageSize'] = pageSize;
            }

            if (search !== undefined) {
                localVarQueryParameter['search'] = search;
            }

            if (status !== undefined) {
                localVarQueryParameter['status'] = status;
            }

            if (sortBy !== undefined) {
                localVarQueryParameter['sortBy'] = sortBy;
            }

            if (sortOrder !== undefined) {
                localVarQueryParameter['sortOrder'] = sortOrder;
            }

            setSearchParams(localVarUrlObj, localVarQueryParameter);
            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};
            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};

            return {
                url: toPathString(localVarUrlObj),
                options: localVarRequestOptions,
            };
        },

        /**
         * åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·è´¦æˆ·
         * @summary åˆ›å»ºæ–°ç”¨æˆ·
         * @param {CreateUserRequest} createUserRequest åˆ›å»ºç”¨æˆ·è¯·æ±‚
         * @param {*} [options] Override http request option.
         * @throws {RequiredError}
         */
        createUser: async (
            createUserRequest: CreateUserRequest, 
            options: AxiosRequestConfig = {}
        ): Promise<RequestArgs> => {
            // verify required parameter 'createUserRequest' is not null or undefined
            assertParamExists('createUser', 'createUserRequest', createUserRequest)
            const localVarPath = `/users`;
            const localVarUrlObj = new URL(localVarPath, DUMMY_BASE_URL);
            let baseOptions;
            if (configuration) {
                baseOptions = configuration.baseOptions;
            }

            const localVarRequestOptions = { method: 'POST', ...baseOptions, ...options};
            const localVarHeaderParameter = {} as any;
            const localVarQueryParameter = {} as any;

            // authentication BearerAuth required
            await setOAuthToObject(localVarHeaderParameter, "BearerAuth", [], configuration)

            localVarHeaderParameter['Content-Type'] = 'application/json';

            setSearchParams(localVarUrlObj, localVarQueryParameter);
            let headersFromBaseOptions = baseOptions && baseOptions.headers ? baseOptions.headers : {};
            localVarRequestOptions.headers = {...localVarHeaderParameter, ...headersFromBaseOptions, ...options.headers};
            localVarRequestOptions.data = serializeDataIfNeeded(createUserRequest, localVarRequestOptions, configuration)

            return {
                url: toPathString(localVarUrlObj),
                options: localVarRequestOptions,
            };
        },

        // å…¶ä»–æ–¹æ³•...
    }
};

/**
 * UsersApi - functional programming interface
 */
export const UsersApiFp = function(configuration?: Configuration) {
    const localVarAxiosParamCreator = UsersApiAxiosParamCreator(configuration)
    return {
        /**
         * åˆ†é¡µè·å–ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒç­›é€‰å’Œæ’åº
         * @summary è·å–ç”¨æˆ·åˆ—è¡¨
         * @param {number} [page] é¡µç 
         * @param {number} [pageSize] æ¯é¡µå¤§å°
         * @param {string} [search] æœç´¢å…³é”®è¯
         * @param {UserStatusEnum} [status] ç”¨æˆ·çŠ¶æ€ç­›é€‰
         * @param {string} [sortBy] æ’åºå­—æ®µ
         * @param {string} [sortOrder] æ’åºæ–¹å‘
         * @param {*} [options] Override http request option.
         * @throws {RequiredError}
         */
        async getUsers(
            page?: number, 
            pageSize?: number, 
            search?: string, 
            status?: UserStatusEnum, 
            sortBy?: string, 
            sortOrder?: string, 
            options?: AxiosRequestConfig
        ): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<ApiResponse<User[]>>> {
            const localVarAxiosArgs = await localVarAxiosParamCreator.getUsers(page, pageSize, search, status, sortBy, sortOrder, options);
            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);
        },

        /**
         * åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·è´¦æˆ·
         * @summary åˆ›å»ºæ–°ç”¨æˆ·
         * @param {CreateUserRequest} createUserRequest åˆ›å»ºç”¨æˆ·è¯·æ±‚
         * @param {*} [options] Override http request option.
         * @throws {RequiredError}
         */
        async createUser(
            createUserRequest: CreateUserRequest, 
            options?: AxiosRequestConfig
        ): Promise<(axios?: AxiosInstance, basePath?: string) => AxiosPromise<ApiResponse<User>>> {
            const localVarAxiosArgs = await localVarAxiosParamCreator.createUser(createUserRequest, options);
            return createRequestFunction(localVarAxiosArgs, globalAxios, BASE_PATH, configuration);
        },

        // å…¶ä»–æ–¹æ³•...
    };
};

/**
 * UsersApi - factory interface
 */
export const UsersApiFactory = function (configuration?: Configuration, basePath?: string, axios?: AxiosInstance) {
    const localVarFp = UsersApiFp(configuration)
    return {
        /**
         * åˆ†é¡µè·å–ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒç­›é€‰å’Œæ’åº
         * @summary è·å–ç”¨æˆ·åˆ—è¡¨
         * @param {UsersApiGetUsersRequest} requestParameters Request parameters.
         * @param {*} [options] Override http request option.
         * @throws {RequiredError}
         */
        getUsers(requestParameters: UsersApiGetUsersRequest = {}, options?: AxiosRequestConfig): AxiosPromise<ApiResponse<User[]>> {
            return localVarFp.getUsers(requestParameters.page, requestParameters.pageSize, requestParameters.search, requestParameters.status, requestParameters.sortBy, requestParameters.sortOrder, options).then((request) => request(axios, basePath));
        },

        /**
         * åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·è´¦æˆ·
         * @summary åˆ›å»ºæ–°ç”¨æˆ·
         * @param {UsersApiCreateUserRequest} requestParameters Request parameters.
         * @param {*} [options] Override http request option.
         * @throws {RequiredError}
         */
        createUser(requestParameters: UsersApiCreateUserRequest, options?: AxiosRequestConfig): AxiosPromise<ApiResponse<User>> {
            return localVarFp.createUser(requestParameters.createUserRequest, options).then((request) => request(axios, basePath));
        },

        // å…¶ä»–æ–¹æ³•...
    };
};

/**
 * Request parameters for getUsers operation in UsersApi.
 */
export interface UsersApiGetUsersRequest {
    /**
     * é¡µç 
     */
    readonly page?: number;
    /**
     * æ¯é¡µå¤§å°
     */
    readonly pageSize?: number;
    /**
     * æœç´¢å…³é”®è¯
     */
    readonly search?: string;
    /**
     * ç”¨æˆ·çŠ¶æ€ç­›é€‰
     */
    readonly status?: UserStatusEnum;
    /**
     * æ’åºå­—æ®µ
     */
    readonly sortBy?: string;
    /**
     * æ’åºæ–¹å‘
     */
    readonly sortOrder?: string;
}

/**
 * Request parameters for createUser operation in UsersApi.
 */
export interface UsersApiCreateUserRequest {
    /**
     * åˆ›å»ºç”¨æˆ·è¯·æ±‚
     */
    readonly createUserRequest: CreateUserRequest;
}

/**
 * UsersApi - object-oriented interface
 */
export class UsersApi extends BaseAPI {
    /**
     * åˆ†é¡µè·å–ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒç­›é€‰å’Œæ’åº
     * @summary è·å–ç”¨æˆ·åˆ—è¡¨
     * @param {UsersApiGetUsersRequest} requestParameters Request parameters.
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof UsersApi
     */
    public getUsers(requestParameters: UsersApiGetUsersRequest = {}, options?: AxiosRequestConfig) {
        return UsersApiFp(this.configuration).getUsers(requestParameters.page, requestParameters.pageSize, requestParameters.search, requestParameters.status, requestParameters.sortBy, requestParameters.sortOrder, options).then((request) => request(this.axios, this.basePath));
    }

    /**
     * åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·è´¦æˆ·
     * @summary åˆ›å»ºæ–°ç”¨æˆ·
     * @param {UsersApiCreateUserRequest} requestParameters Request parameters.
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof UsersApi
     */
    public createUser(requestParameters: UsersApiCreateUserRequest, options?: AxiosRequestConfig) {
        return UsersApiFp(this.configuration).createUser(requestParameters.createUserRequest, options).then((request) => request(this.axios, this.basePath));
    }

    // å…¶ä»–æ–¹æ³•...
}
```

### 4. é«˜çº§å°è£…å’Œé›†æˆ

#### 4.1 Vueç»„åˆå¼APIå°è£…
```typescript
// src/composables/api/useUserApi.ts
import { ref, computed } from 'vue'
import { UsersApi, User, CreateUserRequest, UpdateUserRequest, UserStatusEnum } from '@/api/generated'
import { useApiClient } from '@/composables/useApiClient'
import type { ApiRequestConfig, PaginatedResponse } from '@/types/api'

interface UseUserApiOptions {
  immediate?: boolean
  autoRefresh?: boolean
}

export function useUserApi(options: UseUserApiOptions = {}) {
  const { apiClient, loading, error } = useApiClient()
  const usersApi = new UsersApi(undefined, undefined, apiClient)

  // çŠ¶æ€ç®¡ç†
  const users = ref<User[]>([])
  const currentUser = ref<User | null>(null)
  const pagination = ref<PaginationInfo>()
  
  // è®¡ç®—å±æ€§
  const activeUsers = computed(() => 
    users.value.filter(user => user.status === UserStatusEnum.Active)
  )
  
  const userCount = computed(() => users.value.length)

  // è·å–ç”¨æˆ·åˆ—è¡¨
  const fetchUsers = async (params: {
    page?: number
    pageSize?: number
    search?: string
    status?: UserStatusEnum
    sortBy?: string
    sortOrder?: string
  } = {}) => {
    try {
      loading.value = true
      error.value = null

      const response = await usersApi.getUsers({
        page: params.page ?? 1,
        pageSize: params.pageSize ?? 20,
        search: params.search,
        status: params.status,
        sortBy: params.sortBy ?? 'createdAt',
        sortOrder: params.sortOrder ?? 'desc'
      })

      if (response.data.success) {
        users.value = response.data.data || []
        pagination.value = response.data.pagination
      } else {
        throw new Error(response.data.message || 'è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥')
      }

      return response.data
    } catch (err: any) {
      error.value = err.message || 'è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥'
      throw err
    } finally {
      loading.value = false
    }
  }

  // è·å–ç”¨æˆ·è¯¦æƒ…
  const fetchUserById = async (userId: string) => {
    try {
      loading.value = true
      error.value = null

      const response = await usersApi.getUserById({ userId })

      if (response.data.success) {
        currentUser.value = response.data.data || null
      } else {
        throw new Error(response.data.message || 'è·å–ç”¨æˆ·è¯¦æƒ…å¤±è´¥')
      }

      return response.data.data
    } catch (err: any) {
      error.value = err.message || 'è·å–ç”¨æˆ·è¯¦æƒ…å¤±è´¥'
      throw err
    } finally {
      loading.value = false
    }
  }

  // åˆ›å»ºç”¨æˆ·
  const createUser = async (userData: CreateUserRequest) => {
    try {
      loading.value = true
      error.value = null

      const response = await usersApi.createUser({
        createUserRequest: userData
      })

      if (response.data.success) {
        users.value.push(response.data.data!)
        return response.data.data
      } else {
        throw new Error(response.data.message || 'åˆ›å»ºç”¨æˆ·å¤±è´¥')
      }
    } catch (err: any) {
      error.value = err.message || 'åˆ›å»ºç”¨æˆ·å¤±è´¥'
      throw err
    } finally {
      loading.value = false
    }
  }

  // æ›´æ–°ç”¨æˆ·
  const updateUser = async (userId: string, userData: UpdateUserRequest) => {
    try {
      loading.value = true
      error.value = null

      const response = await usersApi.updateUser({
        userId,
        updateUserRequest: userData
      })

      if (response.data.success) {
        const index = users.value.findIndex(u => u.id === userId)
        if (index !== -1) {
          users.value[index] = response.data.data!
        }
        if (currentUser.value?.id === userId) {
          currentUser.value = response.data.data!
        }
        return response.data.data
      } else {
        throw new Error(response.data.message || 'æ›´æ–°ç”¨æˆ·å¤±è´¥')
      }
    } catch (err: any) {
      error.value = err.message || 'æ›´æ–°ç”¨æˆ·å¤±è´¥'
      throw err
    } finally {
      loading.value = false
    }
  }

  // åˆ é™¤ç”¨æˆ·
  const deleteUser = async (userId: string) => {
    try {
      loading.value = true
      error.value = null

      await usersApi.deleteUser({ userId })

      users.value = users.value.filter(u => u.id !== userId)
      if (currentUser.value?.id === userId) {
        currentUser.value = null
      }

      return true
    } catch (err: any) {
      error.value = err.message || 'åˆ é™¤ç”¨æˆ·å¤±è´¥'
      throw err
    } finally {
      loading.value = false
    }
  }

  // é‡ç½®çŠ¶æ€
  const reset = () => {
    users.value = []
    currentUser.value = null
    pagination.value = undefined
    error.value = null
  }

  // ç«‹å³åŠ è½½
  if (options.immediate) {
    fetchUsers()
  }

  return {
    // çŠ¶æ€
    users: readonly(users),
    currentUser: readonly(currentUser),
    pagination: readonly(pagination),
    loading: readonly(loading),
    error: readonly(error),

    // è®¡ç®—å±æ€§
    activeUsers,
    userCount,

    // æ–¹æ³•
    fetchUsers,
    fetchUserById,
    createUser,
    updateUser,
    deleteUser,
    reset
  }
}
```

#### 4.2 Pinia Storeè‡ªåŠ¨ç”Ÿæˆ
```typescript
// src/stores/generated/userStore.ts (è‡ªåŠ¨ç”Ÿæˆ)
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { useUserApi } from '@/composables/api/useUserApi'
import type { User, CreateUserRequest, UpdateUserRequest, UserStatusEnum } from '@/api/generated'

export const useUserStore = defineStore('user', () => {
  // ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„APIç»„åˆå‡½æ•°
  const userApi = useUserApi()

  // çŠ¶æ€ä»£ç†
  const users = computed(() => userApi.users.value)
  const currentUser = computed(() => userApi.currentUser.value)
  const pagination = computed(() => userApi.pagination.value)
  const loading = computed(() => userApi.loading.value)
  const error = computed(() => userApi.error.value)

  // è®¡ç®—å±æ€§
  const activeUsers = computed(() => userApi.activeUsers.value)
  const userCount = computed(() => userApi.userCount.value)
  const hasUsers = computed(() => userApi.userCount.value > 0)

  // æ–¹æ³•ä»£ç†
  const fetchUsers = userApi.fetchUsers
  const fetchUserById = userApi.fetchUserById
  const createUser = userApi.createUser
  const updateUser = userApi.updateUser
  const deleteUser = userApi.deleteUser
  const reset = userApi.reset

  // æ‰©å±•æ–¹æ³•
  const findUserByEmail = (email: string): User | undefined => {
    return users.value.find(user => user.email === email)
  }

  const getUsersByStatus = (status: UserStatusEnum): User[] => {
    return users.value.filter(user => user.status === status)
  }

  const searchUsers = (query: string): User[] => {
    const lowerQuery = query.toLowerCase()
    return users.value.filter(user => 
      user.name.toLowerCase().includes(lowerQuery) ||
      user.email.toLowerCase().includes(lowerQuery)
    )
  }

  return {
    // çŠ¶æ€
    users,
    currentUser,
    pagination,
    loading,
    error,

    // è®¡ç®—å±æ€§
    activeUsers,
    userCount,
    hasUsers,

    // æ–¹æ³•
    fetchUsers,
    fetchUserById,
    createUser,
    updateUser,
    deleteUser,
    reset,

    // æ‰©å±•æ–¹æ³•
    findUserByEmail,
    getUsersByStatus,
    searchUsers
  }
})

// å¯¼å‡ºç±»å‹
export type UserStore = ReturnType<typeof useUserStore>
```

### 5. è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·é“¾

#### 5.1 æ„å»ºè„šæœ¬é…ç½®
```json
// package.json
{
  "scripts": {
    "codegen": "npm run codegen:clean && npm run codegen:backend && npm run codegen:frontend && npm run codegen:docs",
    "codegen:clean": "rimraf src/api/generated && rimraf ../SmartAbp.Api/Generated",
    "codegen:backend": "openapi-generator-cli generate -i api-contracts/smartabp-api.yaml -g aspnetcore -o ../SmartAbp.Api/Generated -c codegen/backend-config.json",
    "codegen:frontend": "openapi-generator-cli generate -i api-contracts/smartabp-api.yaml -g typescript-axios -o src/api/generated -c codegen/frontend-config.json",
    "codegen:composables": "node scripts/generate-composables.js",
    "codegen:stores": "node scripts/generate-stores.js",
    "codegen:docs": "redoc-cli build api-contracts/smartabp-api.yaml --output docs/api.html",
    "codegen:validate": "swagger-codegen validate -i api-contracts/smartabp-api.yaml",
    "codegen:watch": "chokidar api-contracts/**/*.yaml -c \"npm run codegen\"",
    "api:mock": "prism mock api-contracts/smartabp-api.yaml",
    "api:validate": "spectral lint api-contracts/smartabp-api.yaml"
  },
  "devDependencies": {
    "@openapitools/openapi-generator-cli": "^2.7.0",
    "redoc-cli": "^0.13.21",
    "swagger-codegen": "^1.0.8",
    "chokidar-cli": "^3.0.0",
    "@stoplight/prism-cli": "^5.5.2",
    "@stoplight/spectral-cli": "^6.11.0"
  }
}
```

#### 5.2 ç»„åˆå‡½æ•°è‡ªåŠ¨ç”Ÿæˆè„šæœ¬
```javascript
// scripts/generate-composables.js
const fs = require('fs')
const path = require('path')
const yaml = require('js-yaml')

async function generateComposables() {
  try {
    // è¯»å–APIå¥‘çº¦
    const apiSpec = yaml.load(fs.readFileSync('api-contracts/smartabp-api.yaml', 'utf8'))
    
    // æå–APIå®šä¹‰
    const paths = apiSpec.paths
    const components = apiSpec.components.schemas
    
    // ä¸ºæ¯ä¸ªèµ„æºç”Ÿæˆç»„åˆå‡½æ•°
    for (const [path, methods] of Object.entries(paths)) {
      const resource = extractResourceName(path)
      const composableCode = generateComposableCode(resource, methods, components)
      
      // å†™å…¥æ–‡ä»¶
      const outputPath = `src/composables/api/use${capitalize(resource)}Api.ts`
      fs.writeFileSync(outputPath, composableCode)
      
      console.log(`Generated composable: ${outputPath}`)
    }
    
    // ç”Ÿæˆç´¢å¼•æ–‡ä»¶
    generateComposableIndex()
    
  } catch (error) {
    console.error('Error generating composables:', error)
    process.exit(1)
  }
}

function extractResourceName(path) {
  const parts = path.split('/')
  return parts[1] // å‡è®¾è·¯å¾„æ ¼å¼ä¸º /users, /projects ç­‰
}

function generateComposableCode(resource, methods, components) {
  // ç”Ÿæˆç»„åˆå‡½æ•°ä»£ç æ¨¡æ¿
  return `
// æ­¤æ–‡ä»¶ç”±å·¥å…·è‡ªåŠ¨ç”Ÿæˆï¼Œè¯·å‹¿æ‰‹åŠ¨ä¿®æ”¹
import { ref, computed } from 'vue'
import { ${capitalize(resource)}Api, type ${capitalize(resource)} } from '@/api/generated'
import { useApiClient } from '@/composables/useApiClient'

export function use${capitalize(resource)}Api() {
  const { apiClient, loading, error } = useApiClient()
  const ${resource}Api = new ${capitalize(resource)}Api(undefined, undefined, apiClient)

  // çŠ¶æ€ç®¡ç†
  const ${resource}s = ref<${capitalize(resource)}[]>([])
  const current${capitalize(resource)} = ref<${capitalize(resource)} | null>(null)

  // ç”Ÿæˆçš„æ–¹æ³•...
  ${generateApiMethods(resource, methods)}

  return {
    ${resource}s: readonly(${resource}s),
    current${capitalize(resource)}: readonly(current${capitalize(resource)}),
    loading: readonly(loading),
    error: readonly(error),
    
    // æ–¹æ³•å¯¼å‡º...
    ${generateMethodExports(methods)}
  }
}
  `.trim()
}

function generateApiMethods(resource, methods) {
  // æ ¹æ®OpenAPIå®šä¹‰ç”Ÿæˆå…·ä½“çš„APIæ–¹æ³•
  let code = ''
  
  for (const [method, definition] of Object.entries(methods)) {
    if (method === 'get') {
      code += generateGetMethod(resource, definition)
    } else if (method === 'post') {
      code += generatePostMethod(resource, definition)
    }
    // ... å…¶ä»–æ–¹æ³•
  }
  
  return code
}

// æ‰§è¡Œç”Ÿæˆ
generateComposables()
```

#### 5.3 CI/CDé›†æˆé…ç½®
```yaml
# .github/workflows/codegen.yml
name: API Code Generation

on:
  push:
    paths:
      - 'api-contracts/**/*.yaml'
      - 'api-contracts/**/*.yml'
  pull_request:
    paths:
      - 'api-contracts/**/*.yaml'
      - 'api-contracts/**/*.yml'

jobs:
  validate-and-generate:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'

    - name: Install dependencies
      run: npm ci

    - name: Validate API Specification
      run: |
        npm run api:validate
        npm run codegen:validate

    - name: Generate Code
      run: |
        npm run codegen

    - name: Run Tests
      run: |
        npm run test
        npm run type-check

    - name: Check for changes
      id: verify-changed-files
      run: |
        if [ -n "$(git status --porcelain)" ]; then
          echo "changed=true" >> $GITHUB_OUTPUT
          git status --porcelain
        else
          echo "changed=false" >> $GITHUB_OUTPUT
        fi

    - name: Commit generated code
      if: steps.verify-changed-files.outputs.changed == 'true'
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add .
        git commit -m "Auto-generate API client code [skip ci]" || exit 0
        git push
```

### 6. ç‰ˆæœ¬ç®¡ç†å’Œå‘å‰å…¼å®¹

#### 6.1 APIç‰ˆæœ¬ç­–ç•¥
```typescript
// src/api/versions.ts
export const API_VERSIONS = {
  v1: {
    version: '1.0.0',
    baseUrl: '/api/v1',
    deprecated: false,
    supportedUntil: '2025-12-31'
  },
  v2: {
    version: '2.0.0',
    baseUrl: '/api/v2',
    deprecated: false,
    supportedUntil: null
  }
} as const

export type ApiVersion = keyof typeof API_VERSIONS

// ç‰ˆæœ¬åŒ–çš„APIå®¢æˆ·ç«¯
export class VersionedApiClient {
  private clients: Map<ApiVersion, Configuration> = new Map()

  constructor() {
    // ä¸ºæ¯ä¸ªç‰ˆæœ¬åˆ›å»ºé…ç½®
    Object.entries(API_VERSIONS).forEach(([version, config]) => {
      this.clients.set(version as ApiVersion, new Configuration({
        basePath: config.baseUrl,
        apiKey: this.getApiKey(),
        // å…¶ä»–é…ç½®...
      }))
    })
  }

  getClient(version: ApiVersion = 'v2'): Configuration {
    const client = this.clients.get(version)
    if (!client) {
      throw new Error(`API version ${version} not supported`)
    }

    // æ£€æŸ¥ç‰ˆæœ¬æ˜¯å¦è¢«å¼ƒç”¨
    const versionInfo = API_VERSIONS[version]
    if (versionInfo.deprecated) {
      console.warn(`API version ${version} is deprecated. Please upgrade to a newer version.`)
    }

    return client
  }
}
```

#### 6.2 Breaking Changeæ£€æµ‹
```javascript
// scripts/detect-breaking-changes.js
const SwaggerParser = require('@apidevtools/swagger-parser')
const { diff } = require('@apidevtools/openapi-diff')

async function detectBreakingChanges() {
  try {
    const oldSpec = await SwaggerParser.parse('api-contracts/previous/smartabp-api.yaml')
    const newSpec = await SwaggerParser.parse('api-contracts/smartabp-api.yaml')
    
    const changes = await diff(oldSpec, newSpec)
    
    const breakingChanges = changes.filter(change => change.breaking)
    
    if (breakingChanges.length > 0) {
      console.error('âš ï¸  Breaking changes detected:')
      breakingChanges.forEach(change => {
        console.error(`  - ${change.type}: ${change.description}`)
        console.error(`    Path: ${change.path}`)
        console.error(`    Details: ${JSON.stringify(change.details, null, 2)}`)
      })
      
      // å¦‚æœæ˜¯CIç¯å¢ƒï¼Œåˆ™å¤±è´¥é€€å‡º
      if (process.env.CI) {
        process.exit(1)
      }
    } else {
      console.log('âœ… No breaking changes detected')
    }
    
  } catch (error) {
    console.error('Error detecting breaking changes:', error)
    process.exit(1)
  }
}

detectBreakingChanges()
```

## ğŸ“Š å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€è®¾æ–½æ­å»º (Week 1-2)
**ç›®æ ‡**: å»ºç«‹ä»£ç ç”Ÿæˆå·¥å…·é“¾å’ŒåŸºç¡€æ¶æ„

**ä»»åŠ¡æ¸…å•**:
- [ ] å®‰è£…å’Œé…ç½®OpenAPI Generator
- [ ] è®¾ç½®é¡¹ç›®ç›®å½•ç»“æ„
- [ ] åˆ›å»ºåŸºç¡€APIå¥‘çº¦æ–‡ä»¶
- [ ] é…ç½®æ„å»ºè„šæœ¬å’Œå·¥å…·é“¾
- [ ] å»ºç«‹CI/CDç®¡é“

**äº¤ä»˜ç‰©**:
- å®Œæ•´çš„ä»£ç ç”Ÿæˆå·¥å…·é“¾
- åŸºç¡€APIå¥‘çº¦å®šä¹‰
- è‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½²è„šæœ¬

### Phase 2: åç«¯ä»£ç ç”Ÿæˆ (Week 3-4)
**ç›®æ ‡**: å®ç°åç«¯Controllerå’Œæ¨¡å‹çš„è‡ªåŠ¨ç”Ÿæˆ

**ä»»åŠ¡æ¸…å•**:
- [ ] å®Œå–„APIå¥‘çº¦å®šä¹‰(ç”¨æˆ·ã€é¡¹ç›®ã€æ—¥å¿—æ¨¡å—)
- [ ] é…ç½®åç«¯ä»£ç ç”Ÿæˆå™¨
- [ ] ç”ŸæˆControlleråŸºç±»å’Œæ¨¡å‹
- [ ] å®ç°å…·ä½“ä¸šåŠ¡é€»è¾‘
- [ ] é›†æˆåˆ°ç°æœ‰é¡¹ç›®æ¶æ„

**äº¤ä»˜ç‰©**:
- è‡ªåŠ¨ç”Ÿæˆçš„åç«¯ä»£ç 
- å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘å®ç°
- APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ

### Phase 3: å‰ç«¯ä»£ç ç”Ÿæˆ (Week 5-6)
**ç›®æ ‡**: å®ç°å‰ç«¯APIå®¢æˆ·ç«¯å’Œç±»å‹çš„è‡ªåŠ¨ç”Ÿæˆ

**ä»»åŠ¡æ¸…å•**:
- [ ] é…ç½®å‰ç«¯TypeScriptä»£ç ç”Ÿæˆå™¨
- [ ] ç”ŸæˆAPIå®¢æˆ·ç«¯å’Œç±»å‹å®šä¹‰
- [ ] åˆ›å»ºVueç»„åˆå‡½æ•°å°è£…
- [ ] é›†æˆåˆ°Pinia Store
- [ ] å®ç°é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†

**äº¤ä»˜ç‰©**:
- è‡ªåŠ¨ç”Ÿæˆçš„å‰ç«¯APIä»£ç 
- ç±»å‹å®‰å…¨çš„APIå®¢æˆ·ç«¯
- Vueç»„åˆå‡½æ•°å’ŒStoreé›†æˆ

### Phase 4: é«˜çº§åŠŸèƒ½å’Œä¼˜åŒ– (Week 7-8)
**ç›®æ ‡**: å®ç°é«˜çº§åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç°APIç‰ˆæœ¬ç®¡ç†
- [ ] æ·»åŠ Breaking Changeæ£€æµ‹
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥
- [ ] å®ç°å¥‘çº¦æµ‹è¯•
- [ ] æ–‡æ¡£å’Œç¤ºä¾‹å®Œå–„

**äº¤ä»˜ç‰©**:
- ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿ
- æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ
- å®Œæ•´çš„æ–‡æ¡£å’Œç¤ºä¾‹

### Phase 5: é›†æˆæµ‹è¯•å’Œéƒ¨ç½² (Week 9-10)
**ç›®æ ‡**: å®Œæ•´çš„é›†æˆæµ‹è¯•å’Œç”Ÿäº§éƒ¨ç½²

**ä»»åŠ¡æ¸…å•**:
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•å®ç°
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [ ] ç›‘æ§å’Œå‘Šè­¦é…ç½®
- [ ] å›¢é˜ŸåŸ¹è®­å’Œæ–‡æ¡£

**äº¤ä»˜ç‰©**:
- å®Œæ•´çš„æµ‹è¯•è¦†ç›–
- ç”Ÿäº§å°±ç»ªçš„éƒ¨ç½²æ–¹æ¡ˆ
- å›¢é˜ŸåŸ¹è®­å’Œä½¿ç”¨æŒ‡å—

## ğŸ¯ é¢„æœŸæ”¶ç›Š

### å¼€å‘æ•ˆç‡æå‡
- **90%å‡å°‘é‡å¤ä»£ç ç¼–å†™** - APIå®¢æˆ·ç«¯å’Œç±»å‹å®šä¹‰è‡ªåŠ¨ç”Ÿæˆ
- **80%å‡å°‘è°ƒè¯•æ—¶é—´** - ç±»å‹å®‰å…¨å’Œå¥‘çº¦éªŒè¯
- **70%å‡å°‘APIæ–‡æ¡£ç»´æŠ¤** - æ–‡æ¡£ä¸ä»£ç 100%åŒæ­¥
- **60%å‡å°‘é›†æˆæµ‹è¯•æ—¶é—´** - è‡ªåŠ¨å¥‘çº¦æµ‹è¯•

### ä»£ç è´¨é‡æå‡
- **100%ç±»å‹å®‰å…¨** - å‰åç«¯ç±»å‹å®Œå…¨ä¸€è‡´
- **é›¶APIä¸ä¸€è‡´é—®é¢˜** - å¥‘çº¦é©±åŠ¨å¼€å‘
- **æ ‡å‡†åŒ–å“åº”æ ¼å¼** - ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ•°æ®ç»“æ„
- **è‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›–** - å¥‘çº¦æµ‹è¯•å’Œå•å…ƒæµ‹è¯•

### ç»´æŠ¤æˆæœ¬é™ä½
- **APIå˜æ›´è‡ªåŠ¨åŒæ­¥** - å‰åç«¯ä»£ç è‡ªåŠ¨æ›´æ–°
- **Breaking Changeé¢„è­¦** - é¿å…æ„å¤–çš„APIç ´å
- **ç‰ˆæœ¬ç®¡ç†è‡ªåŠ¨åŒ–** - æ”¯æŒå¤šç‰ˆæœ¬APIå¹¶å­˜
- **æ–‡æ¡£æ°¸è¿œæœ€æ–°** - è‡ªåŠ¨ç”Ÿæˆå’Œæ›´æ–°

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2024-01-15  
**æœ€åæ›´æ–°**: 2024-01-15  
**è´Ÿè´£äºº**: æ¶æ„å›¢é˜Ÿ  
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸

